      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION  DIVISION.
       PROGRAM-ID.     SEIKYU0107.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ÃÏÊý¸øÈñ
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ËÌ³¤Æ»¡¦½ÅÅÙ¿´¿È¾ã¤¬¤¤¼Ô°åÎÅÈñÀÁµá½ñ
      *                      (143,243,343,543,643,743,843)
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  05/04/20    »³¸ý          ORCA¤Î¥Ð¡¼¥¸¥ç¥ó¥¢¥Ã¥×(2.5.0)¤Ë¤è¤ëºÆºîÀ®
      *                            ·îÅÓÃæ¤Î¸øÈñÀÚÂØ¤¨ÂÐ±þ
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev	½¤Àµ¼Ô	ÆüÉÕ		ÆâÍÆ
      *  01.00.01     Í­Â¼     05/05/06    °åÎÅµ¡´Ø¾ðÊó¼èÆÀ¾ò·ï½¤Àµ
      *  01.00.02     »³¸ý     05/09/14    ½é¿Ç¥Ç¡¼¥¿¤Î½¸·×ÊýË¡½¤Àµ
      *  01.00.03     ÆâÅÄ     07/02/14    °õ»úÂÐ¾ÝÈÖ¹æ¤ÎÄÉ²Ã¡Ê643¡Ë
      *  01.00.04     ÆâÅÄ     07/04/25    Ä¢É¼ÍÍ¼°¤ËÈ¼¤¦½¤Àµ
      *  01.00.05     ÆâÅÄ     07/05/23    Ç§Äê¾Ú¤òÄó¼¨»þ¤Î¤ß71¸ÂÅÙ³Û¤ò°õ»ú
      *                                    ºßÁí¿Ç¤ÎÈ½Äê½¤Àµ
      *                                    Ä¹´ü¾å°ÌÂÐ±þ
      *                                    £³³ä¤Î¾ì¹ç¤â¡û¤Î°õ»ú
      *                                    °õ»úÂÐ¾ÝÈÖ¹æ¤ÎÄÉ²Ã¡Ê743,843¡Ë
      *                                    °°Àî¤ÎÈ÷¹ÍÍó½¤Àµ¡Ê½éºÆ¿Ç¤ÎÈ½Äê¡Ë
      *  01.00.06     ÆâÅÄ     07/06/22    Æ»Æâ¹­°èÏ¢¹ç¤Î¾ì¹ç¡¢»ÔÄ®Â¼Ì¾¤Î¤ß°õ»ú
      *  01.00.07     ÆâÅÄ     07/09/24    ÊÝ¸±ÈÖ¹æ743,843¤Ë¤Æ¸øÈñ¤Î½õÀ®¤¬
      *                                    ¤Ê¤¤¤Ê¤é½¸·×¤·¤Ê¤¤
      *  01.00.08     ÆâÅÄ     07/09/26    Æü¥ì¥»ver4.0ÂÐ±þ
      *                                    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¡Ö1901¡×¤Î
      *                                    °åÎÅµ¡´Ø¾ðÊó¤ò»²¾È
      *  01.00.09     ÆâÅÄ     08/03/26    ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¤¤Ê¤é½¸·×¤·¤Ê¤¤(743)
      *  01.00.10     ÆâÅÄ     08/05/02    ¸å´ü¹âÎð¼Ô¤ò¾ãÏ·¿ÍÍó¤Ø°õ»ú
      *  01.00.11     ÆâÅÄ     08/07/01    »¥ËÚ»ÔÂåÉ½ÊÝ¸±¼ÔÈÖ¹æÊÑ¹¹
      *  01.00.12     µÈÀî     08/09/11    SPA-AREA½é´ü²½
      *  01.00.13     µÈÀî     08/11/25    Ä¹´üÅù¤ÈÊ»ÍÑ¤·¤¿¾ì¹ç¡¢¸øÈñ¤Î½õÀ®¤¬
      *                                    Ìµ¤¯¤Æ¤â°õ»ú¤µ¤ì¤ëÉÔ¶ñ¹ç¤ò½¤Àµ
      *  01.00.14     µÈÀî     09/01/15    ³°Íè¤ÇÁ´¹ñ¸øÈñÊ»ÍÑ¤Î¾ì¹ç¤Ï¡¢
      *                                    ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú
      *  01.00.15     ÆâÅÄ     09/05/22    ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú
      *                                    ¾å¸ÂÃ£¤·¤¿»þ¤Î°°Àî»Ô¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ
      *                                    ¡Öºß¡×¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢
      *                                    ¡Ö£²¡¦£³³ä¡×¤Ë¡û¤ÏÉÔÍ×
      *  01.00.16     µÈÀî     09/07/10    ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú¤¹¤ë¤Î¤Ï
      *                                    È¡´Û»ÔÅù£¸»Ô¤Î¤ß¤Ë¤¹¤ë
      *                                    ¡Ö£²¡¦£³³ä¡×°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢
      *                                    ¡Ö£²¡¦£³³ä¡×¤Ë¡û¤ÏÉÔÍ×
      *  01.00.17     µÈÀî     09/09/29    Á´»ÔÄ®Â¼¤ÇÄ¹´üµÚ¤ÓÁ´¹ñ¸øÈñÊ»ÍÑ»þ¤Ï
      *                                    ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú¤¹¤ë
      *  01.00.18     µÈÀî     09/10/05    Á´¹ñ¸øÈñ¤ÈÄ¹´ü¤ò»ý¤Ã¤Æ¤¤¤ë¾ì¹ç¡¢
      *                                    ¡ÖÄ¹¡×¤Ë¡û¤¬ÉÕ¤«¤Ê¤¤ÉÔ¶ñ¹ç¤ò½¤Àµ
      *                                    543¤ÈÄ¹´ü¤òÊ»ÍÑ»þ¡¢°ìÉôÉéÃ´¶â¤¬
      *                                    Ä¹´ü¤Î¸ÂÅÙ³Û¤òÄ¶¤¨¤ëÉÔ¶ñ¹ç¤ò½¤Àµ
      *                                    Ä¹´ü¤Ç¼ÂÆü¿ô¤¬1Æü¤Î¤ß¤Î¾ì¹ç¡¢
      *                                    Ä¹´ü¤È¤Ê¤é¤Ê¤¤ÉÔ¶ñ¹ç¤ò½¤Àµ
      *                        09/10/22    Á´¹ñ¸øÈñ¤ò»ý¤Ã¤Æ¤¤¤Æ¤â
      *                                    Áë¸ýÄ§¼ý¶â¤¬È¯À¸¤·¤Ê¤¤¾ì¹ç¤Ï
      *                                    °õ»úÂÐ¾Ý³°¤È¤¹¤ë¤è¤¦¤Ë½¤Àµ
      *  01.00.19     µÈÀî     09/12/17    Á´¹ñ¸øÈñ¤ÈÄ¹´ü¤¬Å¬ÍÑ¤È¤Ê¤Ã¤¿¾ì¹ç
      *                                    ¾å¸Â³Û¤ÎÄã¤¤Êý¤Ë¡û¤ò°õ»ú¤¹¤ë
      *  01.00.20     µÈÀî     10/02/12    È¡´Û»Ô¤Ï¸øÈñ¤Î½õÀ®¤¬¤Ê¤¤¾ì¹ç
      *                                    °õ»úÂÐ¾Ý³°¤È¤¹¤ë
      *  01.00.21     µÈÀî     10/03/25    ¿ÇÎÅÆþÎÏ½ç¤Ë¤è¤Ã¤Æ¤Ï¥Ç¡¼¥¿¤¬
      *                                    °õ»ú¤µ¤ì¤Ê¤¤¾ì¹ç¤¬¤¢¤ë¤Î¤ò½¤Àµ
      *  01.00.22     µÈÀî     10/11/16    ¼¼Íö»Ô¡¢¶üÏ©»Ô¡¢¹¾ÊÌ»Ô¡¢º¬¼¼»Ô¤Ï
      *                                    ¸øÈñ¤Î½õÀ®¤¬Ìµ¤¤¾ì¹ç¤Ï°õ»úÂÐ¾Ý³°
      *  01.00.23     µÈÀî     11/02/04    ¾®Ã®»Ô¡¢ÅÐÊÌ»Ô¡¢ËÌ¹­Åç»Ô¤Ï
      *                                    ¸øÈñ¤Î½õÀ®¤¬Ìµ¤¤¾ì¹ç¤Ï°õ»úÂÐ¾Ý³°
      *  01.00.24     µÈÀî     11/02/16    ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose½èÍý°ÌÃÖÊÑ¹¹
      *  01.00.25     µÈÀî     12/04/09    Ä¢É¼ÍÍ¼°¤ÎÊÑ¹¹¤ËÈ¼¤¦½¤Àµ
      *                                    ³°Íè¤â¹â³Û¸ÂÅÙ³Û¤ò°õ»ú¤¹¤ë
      *  01.00.26     µÈÀî     12/07/12    ¹â³ÛÎÅÍÜÈñ¤ÈÄ¹´ü¤ò»ý¤Ã¤Æ¤¤¤ë¾ì¹ç
      *                                    ¸ÂÅÙ³ÛÍó¤ËÃÍ¤¬µ­ºÜ¤µ¤ì¤ë¤Î¤ò½¤Àµ
      *                                    ÆÃÄê¼À´µ¤È957Åù¤ò»ý¤Ã¤Æ¤¤¤ë¾ì¹ç
      *                                    ¸ÂÅÙ³ÛÍó¤ËÃÍ¤¬µ­ºÜ¤µ¤ì¤ë¤Î¤ò½¤Àµ
      *  01.00.27     µÈÀî     12/12/13    643¤Ç½é¿Ç¤Î¾ì¹ç¡¢°ìÉôÉéÃ´¶âÍó¤Ï
      *                                    ½é¿Ç»þ°ìÉôÉéÃ´¶â580±ß¤È¤Îº¹³Û¤òµ­ºÜ
      *                                    643¤Ç¾å¸Â³Û¤ËÃ£¤¹¤ë¤È¡¢È÷¹ÍÍó¤Î
      *                                    °õ»ú¤¬¤µ¤ì¤Ê¤«¤Ã¤¿¤Î¤ò½¤Àµ
      *                                    643¤Ç´µ¼ÔÉéÃ´³Û¤¬580±ßÌ¤Ëþ¤Î¾ì¹ç¡¢
      *                                    È÷¹ÍÍó¤Î¿ô»ú¤Ï´µ¼ÔÉéÃ´³Û¤òµ­ºÜ
      *                                    °åÎÅµ¡´Ø¾ðÊóÊÔ½¸½¤Àµ
      *  01.00.28     µÈÀî     13/03/18    °°Àî»Ô½õÀ®Ê¬¤¬580±ßÌ¤Ëþ¤Î¾ì¹ç¤Î
      *                                    È÷¹ÍÍó¤Î¶â³Û¤ò½¤Àµ
      *                                    ¸ÂÅÙ³ÛÍó¤ÈÁ°´ü¹âÎð¼ÔÍó¤ÎÎ¾Êý¤Ë
      *                                    ÃÍ¤¬¤¢¤ë¾ì¹ç¡¢Á°´ü¹âÎð¼Ô¤Î¤ß°õ»ú
      *  01.00.29     µÈÀî     13/06/10    743¤Î¾ì¹ç¤ÎÈ÷¹ÍÍó¤Î°õ»ú½¤Àµ
      *                                    ºßÂð¤Ï70ºÐÌ¤Ëþ¤Î¾ì¹ç¤Ç¤â°õ»ú¤¹¤ë
      *                                    70ºÐÌ¤Ëþ¤Ç343¡Ü¹â³Û¤Î¾ì¹ç
      *                                    ¸ÂÅÙ³ÛÍó¤Ë°õ»ú¤µ¤ì¤Ê¤¤¤Î¤ò½¤Àµ
      *  01.00.30     µÈÀî     13/07/26    ºßÂð¤ÎÂÐ¾Ý¥³¡¼¥É¤òÁý¤ä¤¹
      *  01.00.31     µÈÀî     14/03/10    743¤ò»ÈÍÑ»þ¡¢°°Àî»Ô½õÀ®Ê¬¤¬
      *                                    580±ßÌ¤Ëþ¤Î¾ì¹ç¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ
      *  01.00.32     µÈÀî     14/03/14    ¾ÃÈñÀÇ²þÀµÂÐ±þ
      *  01.00.33     µÈÀî     14/05/20    ºßÂð¤ÎÂÐ¾Ý¤È¤¹¤ë¿ÇÎÅ¥³¡¼¥ÉÊÑ¹¹
      *  01.00.34     µÈÀî     15/06/11    ÊÝ¸±ÈÖ¹æ343¤Î¥Þ¥¹¥¿¼èÆÀ»þ
      *                                    Å¬ÍÑ´ü´ÖÆâ¤Î¥Ç¡¼¥¿¤ò¼èÆÀ¤¹¤ë
      *  01.00.35     µÈÀî     15/08/12    Æ»ÆñÉÂ¤Ë¤è¤Ã¤Æ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¤¾ì¹ç
      *                                    °õ»úÂÐ¾Ý³°¤È¤¹¤ë¤è¤¦¤Ë½¤Àµ
      *****************************************************************
      *
       ENVIRONMENT   DIVISION.
       CONFIGURATION SECTION.
       INPUT-OUTPUT  SECTION.
       FILE-CONTROL.
      *
      *    ÀÁµá½ñÍÑ¥Õ¥¡¥¤¥ë
           SELECT  MF100-FILE   ASSIGN    MF100PARA
                               ORGANIZATION    IS  INDEXED
                               ACCESS  MODE    IS  DYNAMIC
                               RECORD  KEY     IS  MF100-KEY
                               FILE    STATUS  IS  STS-MF100.
      *
006900*    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
           SELECT  RECEERR-FILE ASSIGN  RECEERR
                                FILE    STATUS  IS  STS-RECEERR.
      *
       DATA  DIVISION.
       FILE  SECTION.
      *
      *
      *    ½¸·×¥Õ¥¡¥¤¥ë
       FD  MF100-FILE.
       01  MF100-REC.
           COPY  "SEI0107.INC".
006900*    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
       FD  RECEERR-FILE.
       01  RECEERR-REC  PIC X(200).
      *
       WORKING-STORAGE  SECTION.
      *
      *
           COPY  "CPCOMMONDAT2.INC"
                   REPLACING  //RECE01//
                   BY         //MF100//.
      *
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë Ì¾¾ÎÎÎ°è
      *---(01.00.08) LINE ADD START ------------------------------------
      *     COPY  "CPCOMMONDAT2.INC"
      *             REPLACING  //RECE01PARA//
      *             BY         //RECEERR//.
      *     03      PIC X(04)   VALUE   ".dat".
           COPY    "CPERRFL.INC"    REPLACING  //ERRFLPARA//
                                    BY         //RECEERR//.
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           COPY  "SC0107.INC".
      *
      *    ¥¹¥ÑÎÎ°è
       01  STS-AREA.
           03  STS-MF100      PIC X(02).
           03  STS-RECE02     PIC X(02).
           03  STS-RECEERR    PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-PTINF      PIC 9(01).
           03  FLG-END        PIC 9(01).
           03  FLG-MF100      PIC 9(01).
           03  FLG-PRINT      PIC 9(01).
           03  FLG-SYSKANRI   PIC 9(01).
           03  FLG-ERR        PIC 9(01).
           03  FLG-SYUNOU     PIC 9(01).
           03  FLG-HEIYOU     PIC 9(01).
           03  FLG-TYOKI      PIC 9(01).
           03  FLG-SYOSIN     PIC 9(01).
           03  FLG-JYURRK     PIC 9(01).
           03  FLG-SRYACCT    PIC 9(01).
           03  FLG-SYOKEI     PIC 9(01).
           03  FLG-HKNJAINF   PIC 9(01).
           03  FLG-HKNNUM     PIC 9(01).
           03  FLG-HKNCOMBI   PIC 9(01).
           03  FLG-BTPARA     PIC 9(01).
           03  FLG-SYORI      PIC 9(01).
      ***** 05/09/14 yamaguchi INS
           03  FLG-SRYACT     PIC 9(01).
      *****
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
           03  FLG-ERR2       PIC 9(01).
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
      *=== ¸øÈñ½õÀ®È½Äê¤Î½¤Àµ by Yoshikawa(2010/03/25) start
           03  FLG-SYORI2     PIC 9(01).
      *=== ¸øÈñ½õÀ®È½Äê¤Î½¤Àµ by Yoshikawa(2010/03/25) end
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX            PIC 9(04).
           03  IDXX           PIC 9(04).
           03  IDX1           PIC 9(04).
           03  IDX2           PIC 9(04).
           03  IDX3           PIC 9(04).
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) start
           03  IDX4           PIC 9(04).
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) end
      *=== ºßÂð¥³¡¼¥ÉÊÑ¹¹ by Yoshikawa(2014/05/20) start
           03  IDX5           PIC 9(04).
      *=== ºßÂð¥³¡¼¥ÉÊÑ¹¹ by Yoshikawa(2014/05/20) end
           03  IDX-STG.
               05  IDX-ST     PIC 9(02).
           03  IDX-EDG.
               05  IDX-ED     PIC 9(02).
           03  IDY            PIC 9(04).
           03  IDZ            PIC 9(04).
      *
      *    ¥Ñ¥é¥á¥¿ÎÎ°è
       01  WRK-PARA.
           COPY    "CPORCSPRTLNK.INC".
           03  WRK-PARA-JOBID        PIC 9(07).
           03  WRK-PARA-SHELLID      PIC X(08).
      *---(01.00.08) LINE ADD START ------------------------------------
      *     03  WRK-PARA-HOSPID       PIC X(24).
           03  WRK-PARA-HOSPNUM      PIC 9(02).
      *---(01.00.08) LINE ADD END   ------------------------------------
           03  WRK-PARA-PAGE         PIC 9(10).
           03  WRK-PARA-SYORIFLG     PIC X(01).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-RECEERR           PIC  X(200).
           03  WRK-Z2                PIC ZZ.
           03  WRK-Z3                PIC ZZZ.
           03  WRK-Z5                PIC Z,ZZZ.
           03  WRK-Z6                PIC ZZ,ZZZ.
           03  WRK-Z7                PIC ZZZ,ZZZ.
           03  WRK-Z9                PIC Z,ZZZ,ZZZ.
           03  WRK-SRYYMWH           PIC X(16).
           03  WRK-SEIYMDWH          PIC X(22).
           03  WRK-HENYMDG           PIC X(22).
           03  WRK-SYMD.
               05  WRK-SYY           PIC 9(04).
               05  WRK-SMM           PIC 9(02).
               05  WRK-SDD           PIC 9(02).
           03  WRK-LASTYMD           PIC 9(08).
           03  WRK-NYMD.
               05  WRK-NYY           PIC 9(04).
               05  WRK-NMM           PIC 9(02).
               05  WRK-NDD           PIC 9(02).
           03  WRK-TYMD.
               05  WRK-TYY           PIC 9(04).
               05  WRK-TMM           PIC 9(02).
               05  WRK-TDD           PIC 9(02).
           03  WRK-HKNJANUM          PIC X(05).
           03  WRK-KOHNUM            PIC X(03).
           03  WRK-KOBETUCITYNUM     PIC X(03).
           03  WRK-KOHID             PIC 9(10).
           03  WRK-SRYACCT-PATH      PIC X(64).
           03  WRK-PRTID             PIC X(20).
           03  WRK-TAIHI-TBL.
               05  WRK-T-FTNJANUM    PIC X(20).
               05  WRK-T-TOTALTEN    PIC 9(07).
      *---(01.00.04) LINE ADD START ------------------------------------
               05  WRK-T-KOGAKU      PIC 9(07).
      *---(01.00.04) LINE ADD END   ------------------------------------
               05  WRK-T-SEIKYUGK    PIC 9(07).
               05  WRK-T-ITBFTN      PIC 9(07).
               05  WRK-T-KASAN-FLG   PIC 9(01).
           03  WRK-SYUKEI-TBL.
               05  WRK-SEIKYUGK      PIC 9(07)V9(01).
               05  WRK-SEIKYUGK-G    PIC 9(07).
               05  WRK-SEIKYUGK-G2   PIC 9(07)V9(01).
               05  WRK-KOHTENSU      PIC 9(07).
               05  WRK-KESE          PIC 9(07)V9(01).
               05  WRK-ETC-ITBFTN    PIC 9(07)V9(01).
               05  WRK-ETC-ITBFTN-G  PIC 9(07).
               05  WRK-ETC-SYOSINFTN PIC 9(07)V9(01).
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) start
               05  WRK-ASAHIFTN      PIC 9(07).
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) end
           03  WRK-N-JOUGENGK        PIC 9(07).
           03  WRK-G-JOUGENGK        PIC 9(07).
           03  WRK-KEISAN            PIC 9(07).
           03  WRK-AMARI             PIC 9(02).
           03  WRK-COMPFTN           PIC 9(07).
      *---(01.00.05) LINE ADD START ------------------------------------
           03  WRK-SHOSAI            PIC 9(07).
      *---(01.00.05) LINE ADD END   ------------------------------------
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
           03  WRK-SRYCNT            PIC 9(02).
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
      *---(01.00.08) LINE ADD START ------------------------------------
      *     03  WRK-PATH.
      *         05  FILLER          PIC S9(09)  BINARY.
      *         05  FILLER          PIC S9(09)  BINARY.
      *         05  FILLER          PIC S9(09)  BINARY.
           03  WRK-PATH              PIC X(50).
      *    °åÎÅµ¡´Ø¾ðÊó
           03  WRK-HOSPNAME          PIC X(100).
           03  WRK-HOSPNAME-R        REDEFINES   WRK-HOSPNAME.
               05  WRK-HOSPNAME1     PIC X(50).
               05  WRK-HOSPNAME2     PIC X(50).
           03  WRK-HOSPADRS          PIC X(100).
           03  WRK-HOSPADRS-R        REDEFINES   WRK-HOSPADRS.
               05  WRK-HOSPADRS1     PIC X(50).
               05  WRK-HOSPADRS2     PIC X(50).
           03  WRK-HOSPTEL           PIC X(15).
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    Ê¸»úÊÑ´¹
           03  WRK-MAE-INPUT         PIC X(200).
           03  WRK-OUT-INPUT         PIC X(200).
           03  WRK-HENKAN            PIC X(20).
      *
       01  SUM-AREA.
           03  SUM-KENSU          PIC 9(04) OCCURS 5.
           03  SUM-TENSU7         PIC 9(07).
           03  SUM-TENSU8         PIC 9(07).
           03  SUM-TENSU9         PIC 9(07).
           03  SUM-ZNK            PIC 9(07).
           03  SUM-RJN            PIC 9(07).
           03  SUM-ITBFTN         PIC 9(07).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-RECE02  PIC 9(06).
           03  CNT-MF100   PIC 9(06).
           03  CNT-PAGE    PIC 9(03).
      *
      *    ¥­¡¼ÍÑ¥¨¥ê¥¢
       01  KEY-AREA.
           03  KEY-NEW.
               05  KEY-N-FTNJANUM   PIC X(08).
           03  KEY-OLD.
               05  KEY-O-FTNJANUM   PIC X(08).
      *
      *
       01  TABLE-AREA.
           03  TBL-PARA-OCC    OCCURS  100.
               05  TBL-PARA-HKNJANUM    PIC X(08).
               05  TBL-PARA-PTID        PIC 9(10).
      *
       01  WRK-CONS-PARA-MAX   PIC 9(03)   VALUE   100.
      *
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) start
      *    ¸ÇÄê¹àÌÜ
       01  WRK-CONS-AREA.
      *=== ºßÂð¥³¡¼¥ÉÊÑ¹¹ by Yoshikawa(2014/05/20) start
           03  WRK-CONS-201403         PIC X(06) VALUE "201403".
           03  WRK-CONS-SRYYM-201404   PIC X(06) VALUE "201404".
      *
      **    ºßÂðÁí¹ç¡¦ºßÂðËö´ü¡Êºß°åÁí¡Ë
      *     03  WRK-CONS-ZAITAKU1       PIC X(09) VALUE "114007610".
      *     03  WRK-CONS-ZAITAKU2       PIC X(09) VALUE "114007710".
      *     03  WRK-CONS-ZAITAKU3       PIC X(09) VALUE "114007510".
      *     03  WRK-CONS-ZAITAKU4       PIC X(09) VALUE "114012210".
      *     03  WRK-CONS-ZAITAKU5       PIC X(09) VALUE "114012310".
      *     03  WRK-CONS-ZAITAKU6       PIC X(09) VALUE "114012410".
      **=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) end
      **=== ºßÂð¤ÎÂÐ¾Ý¥³¡¼¥É¤òÁý¤ä¤¹ by Yoshikawa(2013/07/26) start
      **    ÆÃ°åÁí´É¡Êºß»Ù¿ÇÅù¡Ë
      *     03  WRK-CONS-ZAITAKU7       PIC X(09) VALUE "114013010".
      *     03  WRK-CONS-ZAITAKU8       PIC X(09) VALUE "114013110".
      **    ÆÃ°åÁí´É¡Êºß»Ù¿ÇÅù°Ê³°¡Ë
      *     03  WRK-CONS-ZAITAKU9       PIC X(09) VALUE "114013210".
      *     03  WRK-CONS-ZAITAKU10      PIC X(09) VALUE "114013310".
      **    ºß°åÁí´É¡Êµ¡Ç½¶¯²½¤·¤¿ºß»Ù¿ÇÅù¡Ë
      *     03  WRK-CONS-ZAITAKU11      PIC X(09) VALUE "114018710".
      *     03  WRK-CONS-ZAITAKU12      PIC X(09) VALUE "114018810".
      *     03  WRK-CONS-ZAITAKU13      PIC X(09) VALUE "114018910".
      *     03  WRK-CONS-ZAITAKU14      PIC X(09) VALUE "114019010".
      **    ÆÃ°åÁí´É¡Êµ¡Ç½¶¯²½¤·¤¿ºß»Ù¿ÇÅù¡Ë
      *     03  WRK-CONS-ZAITAKU15      PIC X(09) VALUE "114019110".
      *     03  WRK-CONS-ZAITAKU16      PIC X(09) VALUE "114019210".
      *     03  WRK-CONS-ZAITAKU17      PIC X(09) VALUE "114019310".
      *     03  WRK-CONS-ZAITAKU18      PIC X(09) VALUE "114019410".
      **=== ºßÂð¤ÎÂÐ¾Ý¥³¡¼¥É¤òÁý¤ä¤¹ by Yoshikawa(2013/07/26) end
      **
      **=== ¾ÃÈñÀÇ²þÀµÂÐ±þ by Yoshikawa(2014/03/14) start
      *     03  WRK-CONS-201403         PIC X(06) VALUE "201403".
      **=== ¾ÃÈñÀÇ²þÀµÂÐ±þ by Yoshikawa(2014/03/14) end
      *ºßÁí¿Ç¥Æ¡¼¥Ö¥ë
       01  TBL-ZAITAKU-AREA.
           03  FILLER                  PIC X(09) VALUE "114007610".
           03  FILLER                  PIC X(09) VALUE "114007710".
           03  FILLER                  PIC X(09) VALUE "114007510".
           03  FILLER                  PIC X(09) VALUE "114012210".
           03  FILLER                  PIC X(09) VALUE "114012310".
           03  FILLER                  PIC X(09) VALUE "114012410".
           03  FILLER                  PIC X(09) VALUE "114018710".
           03  FILLER                  PIC X(09) VALUE "114018810".
           03  FILLER                  PIC X(09) VALUE "114018910".
           03  FILLER                  PIC X(09) VALUE "114019010".
           03  FILLER                  PIC X(09) VALUE "114019510".
           03  FILLER                  PIC X(09) VALUE "114019610".
           03  FILLER                  PIC X(09) VALUE "114019710".
           03  FILLER                  PIC X(09) VALUE "114019810".
           03  FILLER                  PIC X(09) VALUE "114013010".
           03  FILLER                  PIC X(09) VALUE "114013110".
           03  FILLER                  PIC X(09) VALUE "114013210".
           03  FILLER                  PIC X(09) VALUE "114013310".
           03  FILLER                  PIC X(09) VALUE "114019110".
           03  FILLER                  PIC X(09) VALUE "114019210".
           03  FILLER                  PIC X(09) VALUE "114019310".
           03  FILLER                  PIC X(09) VALUE "114019410".
      *
       01  TBL-ZAITAKU-R  REDEFINES   TBL-ZAITAKU-AREA.
           03  TBL-ZAITAKU             PIC X(09) OCCURS  22.
      *
       01  TBL-ZAITAKU-MAX             PIC 9(02) VALUE   22.
      *
      *ºßÁí¿Ç¥Æ¡¼¥Ö¥ë¡Ê£²£°£±£´Ç¯£´·î¿ÇÎÅÊ¬¡Á¡Ë
       01  TBL-ZAITAKU2-AREA.
           03  FILLER                  PIC X(09) VALUE "114007610".
           03  FILLER                  PIC X(09) VALUE "114007710".
           03  FILLER                  PIC X(09) VALUE "114019510".
           03  FILLER                  PIC X(09) VALUE "114019610".
           03  FILLER                  PIC X(09) VALUE "114019710".
           03  FILLER                  PIC X(09) VALUE "114019810".
           03  FILLER                  PIC X(09) VALUE "114023110".
           03  FILLER                  PIC X(09) VALUE "114023210".
           03  FILLER                  PIC X(09) VALUE "114023310".
           03  FILLER                  PIC X(09) VALUE "114023410".
           03  FILLER                  PIC X(09) VALUE "114023510".
           03  FILLER                  PIC X(09) VALUE "114023610".
           03  FILLER                  PIC X(09) VALUE "114023710".
           03  FILLER                  PIC X(09) VALUE "114023810".
           03  FILLER                  PIC X(09) VALUE "114023910".
           03  FILLER                  PIC X(09) VALUE "114024010".
           03  FILLER                  PIC X(09) VALUE "114024110".
           03  FILLER                  PIC X(09) VALUE "114024210".
           03  FILLER                  PIC X(09) VALUE "114024310".
           03  FILLER                  PIC X(09) VALUE "114024410".
           03  FILLER                  PIC X(09) VALUE "114024510".
           03  FILLER                  PIC X(09) VALUE "114024610".
           03  FILLER                  PIC X(09) VALUE "114024910".
           03  FILLER                  PIC X(09) VALUE "114025010".
           03  FILLER                  PIC X(09) VALUE "114025110".
           03  FILLER                  PIC X(09) VALUE "114025210".
           03  FILLER                  PIC X(09) VALUE "114025310".
           03  FILLER                  PIC X(09) VALUE "114025410".
           03  FILLER                  PIC X(09) VALUE "114025510".
           03  FILLER                  PIC X(09) VALUE "114025610".
           03  FILLER                  PIC X(09) VALUE "114025710".
           03  FILLER                  PIC X(09) VALUE "114025810".
           03  FILLER                  PIC X(09) VALUE "114025910".
           03  FILLER                  PIC X(09) VALUE "114026010".
           03  FILLER                  PIC X(09) VALUE "114026110".
           03  FILLER                  PIC X(09) VALUE "114026210".
           03  FILLER                  PIC X(09) VALUE "114026310".
           03  FILLER                  PIC X(09) VALUE "114026410".
      *
       01  TBL-ZAITAKU2-R  REDEFINES   TBL-ZAITAKU2-AREA.
           03  TBL-ZAITAKU2            PIC X(09) OCCURS  38.
      *
       01  TBL-ZAITAKU2-MAX            PIC 9(02) VALUE   38.
      *=== ºßÂð¥³¡¼¥ÉÊÑ¹¹ by Yoshikawa(2014/05/20) end
      *
      *    DB»²¾ÈÍÑ
      *---(01.00.08) LINE ADD START ------------------------------------
      *     COPY    "ORCA-DBPATH".
           COPY    "COMMON-SPA".
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È¡¡ÎÎ°è
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY  "CPSK1001.INC".
      *
      *    °åÎÅµ¡´Ø¾ðÊó¡Ý½êºßÃÏ¡¢Ï¢ÍíÀè
           COPY  "CPSK1002.INC".
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *    °åÎÅµ¡´ØÊÔ½¸¾ðÊó
           COPY    "CPSK1900.INC".
      *
      *    °åÎÅµ¡´ØÌ¾¾ÎÊÔ½¸¾ðÊó
           COPY    "CPSK1901.INC".
      *
      *    °åÎÅµ¡´Ø½»½êÊÔ½¸¾ðÊó
           COPY    "CPSK1902.INC".
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    ¥¸¥ç¥Ö´ÉÍý¥Þ¥¹¥¿
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *    °õºþ´ÉÍý¥Þ¥¹¥¿
       01  PRTKANRI-REC.
           COPY    "CPPRTKANRI.INC".
      *    °õºþ¥Þ¥¹¥¿
       01  PRTDATA-REC.
           COPY    "CPPRTDATA.INC".
      *
      *    ¼õ¿ÇÍúÎò¾ðÊó
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
      *
      *    ¿ÇÎÅ²ñ·×¥Þ¥¹¥¿
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    ¼ýÇ¼¾ðÊó
       01  SYUNOU-REC.
           COPY  "CPSYUNOU.INC".
      *
      *¡¡¡¡ÊÝ¸±¼Ô¾ðÊó
       01  HKNJAINF-REC.
           COPY    "CPHKNJAINF.INC".
      *
      *    ÊÝ¸±ÈÖ¹æ
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    ´µ¼Ô¾ðÊó
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    ¸øÈñÀÁµá½ñ
           COPY    "CPKOHSKY.INC"
                   REPLACING  //KOHSKY//
                   BY         //RECE02//.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ¥Ñ¥é¥á¥¿
       01  BTPARA-REC.
           COPY    "CPBTPARA.INC".
      *
      ***** 05/09/14 yamaguchi INS
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *****
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *    ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ¥µ¥Ö
           COPY    "CPORCSJOBKANRI.INC".
      *    °õºþ£Ä£ÂÀ©¸æ¥µ¥Ö
           COPY    "CPORCSPRT.INC".
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *
      *    ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY  "MCPAREA".
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".      
      *
           COPY  "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE  SECTION.
       01  COMMAND-PARAM.
           02  FILLER  PIC X(256).
      *****************************************************************
      *
       PROCEDURE  DIVISION
               USING COMMAND-PARAM.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC  SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC
                   UNTIL  FLG-END = 1
      *
           PERFORM 300-END-SEC
      *
           STOP    RUN
           .
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC  SECTION.
      *
           INITIALIZE  FLG-AREA
           INITIALIZE  STS-AREA
           INITIALIZE  WRK-AREA
           INITIALIZE  CNT-AREA
           INITIALIZE  SUM-AREA
           INITIALIZE  KEY-AREA
           INITIALIZE  IDX-AREA
      *=== SPA-AREA½é´ü²½ by Yoshikawa(2008/09/11) start
           INITIALIZE  SPA-AREA
      *=== SPA-AREA½é´ü²½ by Yoshikawa(2008/09/11) end
      *
           DISPLAY "START"
           PERFORM 100-DBOPEN-SEC
      *
           UNSTRING   COMMAND-PARAM    DELIMITED  BY  ","
                                       INTO    LNK-PRTKANRI-RENNUM
                                               LNK-PRTKANRI-TBL-KEY
                                               LNK-PRTKANRI-TBL-GROUP
                                               LNK-PRTKANRI-SHORI-RENNUM
                                               LNK-PRTKANRI-SRYYM
                                               LNK-PRTKANRI-SKYYMD
                                               LNK-PRTKANRI-SHELLID
                                               LNK-PRTKANRI-PRIORITY
                                               LNK-PRTKANRI-TERMID
                                               LNK-PRTKANRI-OPID
                                               LNK-PRTKANRI-PRTNM
                                               WRK-PARA-JOBID
                                               WRK-PARA-SHELLID
      *---(01.00.08) LINE ADD START ------------------------------------
      *                                         WRK-PARA-HOSPID
                                               WRK-PARA-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
                                               WRK-PARA-SYORIFLG
      *---(01.00.08) LINE ADD START ------------------------------------
                                               RECEERR
      *---(01.00.08) LINE ADD END   ------------------------------------
           END-UNSTRING
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    ¥¹¥Æ¥Ã¥×³«»Ï½èÍý
           MOVE    "STS"           TO  SJOBKANRI-MODE
           INITIALIZE                  JOBKANRI-REC
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           MOVE    "SEIKYU0107"    TO  JOB-PGID
      *=== Ä¢É¼¥¿¥¤¥È¥ë½¤Àµ by Yoshikawa(2012/07/12) start
      *     MOVE    "½ÅÅÙ¿´¿È¾ã³²¼Ô°åÎÅÈñÀÁµá½ñ" 
           MOVE    "½ÅÅÙ¿´¿È¾ã¤¬¤¤¼Ô°åÎÅÈñÀÁµá½ñ" 
      *=== Ä¢É¼¥¿¥¤¥È¥ë½¤Àµ by Yoshikawa(2012/07/12) end
                                   TO  JOB-SHELLMSG
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA
                                   JOBKANRI-REC
      *---(01.00.08) LINE ADD START ------------------------------------
                                   SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    ÂÐ¾ÝÇ¯·îºÇ½ªÆü¼èÆÀ
           INITIALIZE  WRK-SYMD
           MOVE    LNK-PRTKANRI-SRYYM  TO    WRK-SYMD(1:6)
           PERFORM 31012-LASTDAY-GET-SEC
           MOVE    WRK-SYMD         TO    WRK-LASTYMD
      *
           MOVE    LNK-PRTKANRI-SRYYM  TO  WRK-SYMD (1:6)
           MOVE    "01"                TO  WRK-SYMD (7:2)
           PERFORM 31012-SEIWA-HEN-SEC
           MOVE    WRK-HENYMDG(1:16)   TO  WRK-SRYYMWH 
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    LNK-PRTKANRI-SKYYMD     TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           IF      STS-DAY-RC1         =   ZERO 
                   MOVE    LNK-DAY2-EDTYMD3    TO  WRK-SEIYMDWH
           END-IF
      *
      *
           MOVE  "MF100ZZ"        TO  MF100PARA-FILE-ID
           MOVE  LNK-PRTKANRI-TERMID(1:16)  TO  MF100PARA-TERMID
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE  WRK-PARA-HOSPNUM           TO  MF100PARA-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  "RECEERR"        TO  RECEERR-FILE-ID
      *     MOVE  LNK-PRTKANRI-TERMID(1:16)  
      *                            TO  RECEERR-TERMID
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    °åÎÅµ¡´Ø£É£ÄÊÔ½¸
           INITIALIZE  SYS-1001-REC
           MOVE  "1001"        TO  SYS-1001-KANRICD
           MOVE  "*"           TO  SYS-1001-KBNCD
      ***** 05/05/06 DEL
      *     MOVE  "99999999"    TO  SYS-1001-STYUKYMD
      *     MOVE  "00000000"    TO  SYS-1001-EDYUKYMD
      ***** 05/05/06 INS
           MOVE    LNK-PRTKANRI-SRYYM(1:6)
                               TO  SYS-1001-STYUKYMD(1:6)
                                   SYS-1001-EDYUKYMD(1:6)
           MOVE    "01"        TO  SYS-1001-STYUKYMD(7:2)
                                   SYS-1001-EDYUKYMD(7:2)
      *****
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE  SPA-HOSPNUM   TO  SYS-1001-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  SYS-1001-REC  TO  MCPDATA-REC
           PERFORM 800-SYSKANRI-READ-SEC
           IF  FLG-SYSKANRI  =  ZERO
             MOVE  MCPDATA-REC  TO  SYS-1001-REC
           ELSE
             DISPLAY "*** SEIKYU0107 SYS 1001 ERR ***"
             MOVE  1            TO  FLG-END
           END-IF
      *
      *    °åÎÅµ¡´Ø¾ðÊó¡Ý½êºßÃÏ¡¢Ï¢ÍíÀè
           INITIALIZE  SYS-1002-REC
           MOVE  "1002"        TO  SYS-1002-KANRICD
           MOVE  "*"           TO  SYS-1002-KBNCD
      ***** 05/05/06 DEL
      *     MOVE  "99999999"    TO  SYS-1002-STYUKYMD
      *     MOVE  "00000000"    TO  SYS-1002-EDYUKYMD
      ***** 05/05/06 INS
           MOVE    LNK-PRTKANRI-SRYYM(1:6)
                               TO  SYS-1002-STYUKYMD(1:6)
                                   SYS-1002-EDYUKYMD(1:6)
           MOVE    "01"        TO  SYS-1002-STYUKYMD(7:2)
                                   SYS-1002-EDYUKYMD(7:2)
      *****
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE  SPA-HOSPNUM   TO  SYS-1002-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  SYS-1002-REC  TO  MCPDATA-REC
           PERFORM 800-SYSKANRI-READ-SEC
           IF  FLG-SYSKANRI  =  ZERO
             MOVE  MCPDATA-REC  TO  SYS-1002-REC
           ELSE
             DISPLAY "*** SEIKYU0107 SYS 1002 ERR ***"
             MOVE  1            TO  FLG-END
           END-IF
      *
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    SYS-1001-HOSPNAME   TO  WRK-HOSPNAME
           MOVE    SYS-1002-ADRS       TO  WRK-HOSPADRS
           MOVE    SYS-1002-TEL        TO  WRK-HOSPTEL
      *    °åÎÅµ¡´ØÊÔ½¸¾ðÊó
           PERFORM 900-1900-READ-SEC
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    £³£´£³¤Î¾å¸Â³Û¼èÆÀ
           PERFORM 940-HKNNUM-SET-SEC
      *
      *    ¥Ñ¥é¥á¥¿ÊÔ½¸½èÍý
           PERFORM 1001-PARA-HENSYU-SEC
      *
           PERFORM 900-KOHSKY-START-SEC
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿ÊÔ½¸½èÍý
      *****************************************************************
       1001-PARA-HENSYU-SEC        SECTION.
      *
           MOVE    ZERO                    TO  IDXX
                                           FLG-SYORI
           INITIALIZE                      TABLE-AREA
      *
           IF      WRK-PARA-SYORIFLG   =   "1" 
               INITIALIZE                      BTPARA-REC
      *---(01.00.08) LINE ADD START ------------------------------------
               MOVE    SPA-HOSPNUM         TO  BTPARA-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
               MOVE    WRK-PARA-SHELLID    TO  BTPARA-SHELLID
               MOVE    WRK-PARA-JOBID      TO  BTPARA-JOBID
               MOVE    BTPARA-REC          TO  MCPDATA-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE    PATH-TBL-BTPARA-KEY5
      *                                     TO  MCP-PATH
      *         MOVE    "DBSELECT"          TO  MCP-FUNC
      *         CALL    "MCPSUB"            USING
      *                                     MCPAREA
      *                                     MCPDATA-REC
               MOVE    "DBSELECT"          TO  MCP-FUNC
               MOVE    "tbl_btpara"        TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"         USING
                                           MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
               IF      MCP-RC              =   ZERO
      *---(01.00.08) LINE ADD START ------------------------------------
      *             MOVE    PATH-TBL-BTPARA-KEY5    TO  MCP-PATH
                   MOVE    "tbl_btpara"    TO  MCP-TABLE
                   MOVE    "key5"          TO  MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
                   PERFORM 900-BTPARA-READ-N-SEC
               ELSE
                   INITIALIZE                  BTPARA-REC
                   MOVE    1               TO  FLG-BTPARA
               END-IF
      *
               PERFORM     UNTIL   FLG-BTPARA  =   1
                   ADD     1                   TO  IDXX
                   IF      BTPARA-INFO-KBN     =   "1"
                     MOVE    1                 TO  FLG-SYORI
                     MOVE    BTPARA-INFO-PARA
                                       TO TBL-PARA-HKNJANUM(IDXX)
                   ELSE
                     MOVE    2                 TO  FLG-SYORI
                     MOVE    BTPARA-INFO-PTID
                                       TO TBL-PARA-PTID(IDXX)
                   END-IF
                   DISPLAY "¥Ñ¥é¥á¥¿¶èÊ¬=" BTPARA-INFO-KBN
                           "¥Ñ¥é¥á¥¿=" BTPARA-INFO-PARA
                           "ÊÝ¸±¼ÔÈÖ¹æ="   TBL-PARA-HKNJANUM(IDXX)
                           "´µ¼ÔÈÖ¹æ="     TBL-PARA-PTID(IDXX)
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *             MOVE    PATH-TBL-BTPARA-KEY5    TO  MCP-PATH
                   MOVE    "tbl_btpara"    TO  MCP-TABLE
                   MOVE    "key5"          TO  MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
                   PERFORM 900-BTPARA-READ-N-SEC
               END-PERFORM
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE    PATH-TBL-BTPARA-KEY5
      *                                     TO  MCP-PATH
               MOVE    "tbl_btpara"        TO  MCP-TABLE
               MOVE    "key5"              TO  MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
               MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *         CALL    "MCPSUB"            USING
      *                                     MCPAREA
      *                                     MCPDATA-REC
               CALL    "ORCDBMAIN"         USING
                                           MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
               IF      IDXX            =   ZERO
                   MOVE    ZERO            TO  WRK-PARA-SYORIFLG
               END-IF
           END-IF 
           .
       1001-PARA-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       200-MAIN-SEC  SECTION.
      *
           OPEN     OUTPUT  MF100-FILE
           CLOSE            MF100-FILE
           OPEN     I-O     MF100-FILE
      *
           MOVE     ZERO    TO      FLG-END
      *
           PERFORM  2001-SYUKEI-SEC
                    UNTIL   FLG-END   =   1
      *
           CLOSE   MF100-FILE
      *
           IF       CNT-RECE02   >       0
                    PERFORM   2002-PRINT-SEC
           END-IF
           MOVE   1   TO   FLG-END
      *
           .
       200-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½¸·×½èÍý£±
      *****************************************************************
       2001-SYUKEI-SEC  SECTION.
      *
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ >       4
             IF  RECE02-KOHNUM (IDZ) = "143" OR "243" OR "343"
      *---(01.00.05) LINE ADD START ------------------------------------
      *---(01.00.03) LINE ADD START ------------------------------------
      **                              OR "543"
      *                              OR "543" OR "643"
      *---(01.00.03) LINE ADD END   ------------------------------------
                                    OR "543" OR "643" OR "743" OR "843"
      *---(01.00.05) LINE ADD END   ------------------------------------
               PERFORM  20011-SYUKEI-SEC
             END-IF
           END-PERFORM
      *
           PERFORM  900-KOHSKY-READ-SEC
      *
           .
       2001-SYUKEI-EXT.
           EXIT.
      **
      *****************************************************************
      *    ½¸·×½èÍý£²
      *****************************************************************
       20011-SYUKEI-SEC  SECTION.
      *
      *    TMP-FILE ¥­¡¼¥»¥Ã¥È
      *
           INITIALIZE       MF100-REC
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  RECE02-HOSPID       TO  MF100-HOSPID
           MOVE  SPA-HOSPNUM         TO  MF100-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  RECE02-PTNUM        TO  MF100-PTNUM
           MOVE  RECE02-HKNJANUM-KEY TO  MF100-HKNJANUM-KEY
           MOVE  RECE02-TEKSTYMD     TO  MF100-TEKSTYMD
           MOVE  RECE02-NYUGAIKBN    TO  MF100-NYUGAIKBN
           MOVE  RECE02-SRYYM        TO  MF100-SRYYM
      *
           MOVE  RECE02-PTID         TO  MF100-PTID
           MOVE  RECE02-NAME         TO  MF100-NAME
           MOVE  RECE02-KANANAME     TO  MF100-KANANAME
           MOVE  RECE02-BIRTHDAY     TO  MF100-BIRTHDAY
           MOVE  RECE02-SEX          TO  MF100-SEX
           MOVE  RECE02-AGE          TO  MF100-AGE
           MOVE  RECE02-HKN          TO  MF100-HKN
           MOVE  RECE02-RJNHKN       TO  MF100-RJNHKN
           MOVE  RECE02-KYURATE      TO  MF100-FTNRATE
           MOVE  RECE02-ZAITAKU      TO  MF100-ZAITAKU
      *
           MOVE  RECE02-KOHINF      (IDZ)  TO  MF100-KOHINF
           MOVE  MF100-KOHFTNJANUM         TO  MF100-FTNJANUM
           MOVE  MF100-KOHJKYSNUM          TO  MF100-JKYSNUM
           COMPUTE IDY     =         IDZ   +   1
           ADD   RECE02-TOTALTEN    (IDY)  TO  MF100-TOTALTEN
           ADD   RECE02-FTNMONEY    (IDY)  TO  MF100-FTNMONEY
      *
           DISPLAY "´µ¼ÔÈÖ¹æ=" MF100-PTNUM
                   "ÊÑ´¹Á°=" MF100-FTNJANUM " " MF100-KOHFTNJANUM
           MOVE     SPACE    TO    WRK-HENKAN
           MOVE     ZERO     TO    IDX2
           PERFORM  VARYING  IDX1  FROM  1   BY  2
                    UNTIL    IDX1  >     20
                    OR       MF100-FTNJANUM(IDX1:2) = SPACE
             EVALUATE  MF100-FTNJANUM(IDX1:2)
             WHEN "£±"
               ADD      1    TO    IDX2
               MOVE    "1"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£²"
               ADD      1    TO    IDX2
               MOVE    "2"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£³"
               ADD      1    TO    IDX2
               MOVE    "3"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£´"
               ADD      1    TO    IDX2
               MOVE    "4"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£µ"
               ADD      1    TO    IDX2
               MOVE    "5"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£¶"
               ADD      1    TO    IDX2
               MOVE    "6"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£·"
               ADD      1    TO    IDX2
               MOVE    "7"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£¸"
               ADD      1    TO    IDX2
               MOVE    "8"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£¹"
               ADD      1    TO    IDX2
               MOVE    "9"   TO    WRK-HENKAN(IDX2:1)
             WHEN "£°"
               ADD      1    TO    IDX2
               MOVE    "0"   TO    WRK-HENKAN(IDX2:1)
             END-EVALUATE
           END-PERFORM
           IF  WRK-HENKAN  NOT  =  SPACE
             MOVE    WRK-HENKAN    TO    MF100-FTNJANUM
                                         MF100-KOHFTNJANUM 
           END-IF
           DISPLAY "ÊÑ´¹¸å=" MF100-FTNJANUM " " MF100-KOHFTNJANUM
      *
      *    ¸ÄÊÌÈ¯¹ÔÍÑ»ÔÄ®Â¼ÈÖ¹æ
           MOVE  MF100-KOHFTNJANUM (1:3)    TO  WRK-KOBETUCITYNUM
      *
      *    ¶èÆâ¤Ï»¥ËÚ»Ô¤ÇÀÁµá¤¹¤ë
           IF  MF100-FTNJANUM(1:1)  =  "4"
      *---(01.00.11) LINE ADD START ------------------------------------
      *       MOVE  "4001"   TO    MF100-FTNJANUM
      *                            MF100-KOHFTNJANUM
             MOVE  "0017"   TO    MF100-FTNJANUM
                                  MF100-KOHFTNJANUM
      *---(01.00.11) LINE ADD END   ------------------------------------
           END-IF
      *
      *    °ìÉôÉéÃ´¶â¤¬¤¢¤ë¸øÈñ¤ò»ÈÍÑ¤·¤Æ¤¤¤ë¾ì¹ç¤Ï½õÀ®ÂÐ¾ÝÈ½Äê¤ò¹Ô¤¦
           MOVE     ZERO                       TO  FLG-ERR
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
           MOVE     ZERO                       TO  FLG-ERR2
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
      *=== ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú by Uchida(2009/05/22) start
      **---(01.00.07) LINE ADD START ------------------------------------
      **     IF   MF100-KOHNUM  =  "143"                         OR
      **          MF100-KOHNUM  =  "343"
      *     IF   MF100-KOHNUM  =  "143"
      *     OR   MF100-KOHNUM  =  "343"
      *     OR   MF100-KOHNUM  =  "643"
      **---(01.00.09) LINE ADD START ------------------------------------
      *     OR   MF100-KOHNUM  =  "743"
      **---(01.00.09) LINE ADD END   ------------------------------------
      *     OR   MF100-KOHNUM  =  "843"
      **---(01.00.07) LINE ADD END   ------------------------------------
      *       MOVE      1                       TO  FLG-ERR
      *     END-IF
      *=== ¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú by Uchida(2009/05/22) end
      *=== ½õÀ®¤Ê¤·¤Îµ­ºÜ¤ÏÈ¡´ÛÅù8»Ô¤Î¤ß by Yoshikawa(2009/07/08) start
      *    ¾®Ã®¡¢ÅÐÊÌ¡¢ËÌ¹­Åç¤Ï½õÀ®ÂÐ¾ÝÈ½Äê¤ò¹Ô¤ï¤Ê¤¤
      *=== È¡´Û»Ô¤Ï¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú by Yoshikawa(2010/02/12) start
      *     IF  WRK-KOBETUCITYNUM  =  "002" OR "003" OR "005" OR "006"
      *                           OR  "017" OR "023" OR "030" OR "051"
      *=== ½õÀ®È½Äê»ÔÄ®Â¼¤ÎÊÑ¹¹ by Yoshikawa(2010/11/16) start
      *     IF  WRK-KOBETUCITYNUM  =  "003" OR "005" OR "006" OR  "017"
      *                           OR  "023" OR "030" OR "051"
      *=== ¸øÈñ½õÀ®È½Äê¤ò¤¹¤ë»ÔÄ®Â¼¤ÎÊÑ¹¹ by Yoshikawa(2011/02/04) start
      *     IF  WRK-KOBETUCITYNUM  =  "003" OR "030" OR "051"
      **=== ½õÀ®È½Äê»ÔÄ®Â¼¤ÎÊÑ¹¹ by Yoshikawa(2010/11/16) end
      **=== È¡´Û»Ô¤Ï¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤â°õ»ú by Yoshikawa(2010/02/12) end
      *         CONTINUE
      *     ELSE
      *         MOVE     1                        TO  FLG-ERR
      *     END-IF
           MOVE     1                          TO  FLG-ERR
      *=== ¸øÈñ½õÀ®È½Äê¤ò¤¹¤ë»ÔÄ®Â¼¤ÎÊÑ¹¹ by Yoshikawa(2011/02/04) end
      *=== ½õÀ®¤Ê¤·¤Îµ­ºÜ¤ÏÈ¡´ÛÅù8»Ô¤Î¤ß by Yoshikawa(2009/07/08) end
      *
      *    Ä¹´ü¡¦·ë³Ë¡¦Àº¿ÀÊÔ½¸
           MOVE     ZERO                       TO  FLG-TYOKI
           MOVE     MF100-KOHNUM               TO  WRK-KOHNUM
           MOVE     MF100-KOHID                TO  WRK-KOHID
           INITIALIZE                              WRK-SYUKEI-TBL
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) start
                                                   WRK-COMPFTN
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) end
           IF      RECE02-NYUGAIKBN    =   "1"
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE    PATH-TBL-SYUNOU-KEY33   TO  WRK-PATH
               MOVE    "key33"                 TO  WRK-PATH
      *---(01.00.08) LINE ADD END   ------------------------------------
           ELSE
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE    PATH-TBL-SYUNOU-KEY25   TO  WRK-PATH
               MOVE    "key25"                 TO  WRK-PATH
      *---(01.00.08) LINE ADD END   ------------------------------------
           END-IF
           PERFORM  920-SYUNOU-SET-SEC
      *
      *    ÊÝ¸±¼ÔÈÖ¹æ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 200111-HKNJANUM-CHK-SEC
      *
           COMPUTE  WRK-SEIKYUGK-G ROUNDED  =  WRK-SEIKYUGK-G2
      *
      *    £µ£´£³¡¦£±³äÁêÅö¶â³ÛÊÔ½¸
           IF  MF100-KOHNUM  =  "543"
             COMPUTE WRK-ETC-ITBFTN-G ROUNDED = WRK-ETC-ITBFTN
             IF  MF100-NYUGAIKBN        =  "1"
               IF  WRK-ETC-ITBFTN-G   >  WRK-N-JOUGENGK
                 MOVE  WRK-N-JOUGENGK TO  WRK-ETC-ITBFTN-G
               END-IF
             ELSE
               IF  WRK-ETC-ITBFTN-G   >   WRK-G-JOUGENGK
                 MOVE  WRK-G-JOUGENGK TO  WRK-ETC-ITBFTN-G
               END-IF
             END-IF
             MOVE     WRK-ETC-ITBFTN-G TO  MF100-ETCFTNMONEY
           END-IF
      *
      *   £²£´£³¡¦½é¿Ç»þ°ìÉôÉéÃ´¶âÁêÅö³ÛÊÔ½¸
           IF     MF100-KOHNUM  =  "243"
             COMPUTE MF100-ETCFTNMONEY ROUNDED = WRK-ETC-SYOSINFTN
           END-IF
      *
      *---(01.00.05) LINE ADD START ------------------------------------
      *    °°Àî¤Î¾ì¹ç¡¢½é¿ÇºÆ¿ÇÈ½Äê
           IF  MF100-KOHNUM  =  "643" OR "743"
             COMPUTE  WRK-SHOSAI  =  RECE02-TOTALTEN (IDY) / 10 * 10
      *=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) start
      **=== ¾å¸ÂÃ£¤·¤¿»þ¤Î°°Àî»Ô¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ by Uchida(2009/05/22) start
      **       IF  RECE02-FTNMONEY (IDY)  <  WRK-SHOSAI
      *       IF  RECE02-FTNMONEY (IDY)  <  WRK-SHOSAI
      *       AND  WRK-SHOSAI <= 12000
      **=== ¾å¸ÂÃ£¤·¤¿»þ¤Î°°Àî»Ô¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ by Uchida(2009/05/22) end
      *         MOVE  1  TO  MF100-SHOSAISIN
      *       END-IF
             COMPUTE WRK-ETC-ITBFTN-G ROUNDED = WRK-ETC-ITBFTN
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) start
      *       IF  WRK-ETC-ITBFTN-G  <  WRK-SHOSAI
      **        580±ß¤ËËþ¤¿¤Ê¤¤¾ì¹ç¡¢È÷¹ÍÍó¤Ë´µ¼ÔÉéÃ´³Û¤òµ­ºÜ
      *         IF  WRK-SHOSAI  <  580
      *           MOVE  WRK-SHOSAI          TO  MF100-ETCFTNMONEY
      *=== 743¤Î¾ì¹ç¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ by Yoshikawa(2013/06/10) start
             IF  MF100-KOHNUM  =  "743"
               IF  WRK-ETC-ITBFTN-G  <  WRK-SHOSAI
      *          580±ß¤ËËþ¤¿¤Ê¤¤¾ì¹ç¡¢È÷¹ÍÍó¤Ë»Ô½õÀ®Ê¬¤òµ­ºÜ
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) start
      *           IF  WRK-SHOSAI  <  580
      *             MOVE  WRK-SHOSAI          TO  MF100-ETCFTNMONEY
                 IF  (WRK-ASAHIFTN  NOT =  ZERO)
                 AND (WRK-ASAHIFTN  <  580)
                   MOVE  WRK-ASAHIFTN          TO  MF100-ETCFTNMONEY
                 ELSE
                   MOVE  580                   TO  MF100-ETCFTNMONEY
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) end
                 END-IF
                 MOVE  WRK-ETC-ITBFTN-G      TO  MF100-FTNMONEY
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) start
      *           IF  MF100-FTNMONEY  NOT =  ZERO
      *             MOVE  580                 TO  MF100-ETCFTNMONEY
      *           END-IF
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) end
                 MOVE  1                     TO  MF100-SHOSAISIN
               END-IF
             ELSE
      *=== 743¤Î¾ì¹ç¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ by Yoshikawa(2013/06/10) end
      *        ´µ¼ÔÉéÃ´³Û¤È·×»»ÉéÃ´¶â¤ÎÃÍ¤¬°ìÃ×¤·¤Ê¤«¤Ã¤¿¤é
      *        ½é¿Ç»þ°ìÉôÉéÃ´¶â¤¬°ú¤«¤ì¤¿¤È¤¤¤¦¤³¤È¤Ê¤Î¤Ç¡¢½é¿Ç¤ÈÈ½Äê
               IF  WRK-COMPFTN  NOT =  WRK-ETC-ITBFTN-G
      *          »Ô½õÀ®Ê¬¤¬580±ß¤ËËþ¤¿¤Ê¤¤¾ì¹ç¡¢È÷¹ÍÍó¤Ë´µ¼ÔÉéÃ´³Û¤òµ­ºÜ
                 IF  (WRK-ASAHIFTN  NOT =  ZERO)
                 AND (WRK-ASAHIFTN  <  580)
                   MOVE  WRK-ASAHIFTN        TO  MF100-ETCFTNMONEY
                 ELSE
                   MOVE  580                 TO  MF100-ETCFTNMONEY
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) end
                 END-IF
                 MOVE  WRK-ETC-ITBFTN-G      TO  MF100-FTNMONEY
                 MOVE  1                     TO  MF100-SHOSAISIN
               END-IF
      *=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) end
      *=== 743¤Î¾ì¹ç¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ by Yoshikawa(2013/06/10) start
             END-IF
      *=== 743¤Î¾ì¹ç¤ÎÈ÷¹ÍÍó°õ»ú½¤Àµ by Yoshikawa(2013/06/10) end
           END-IF
      *---(01.00.05) LINE ADD END   ------------------------------------
      *
      *=== ÆÃ¼À¡Ü957Åù¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) start
      *    ¹â³ÛÎÅÍÜÈñ¥Á¥§¥Ã¥¯
      *    ÆÃ¼À¡Ü957Åù¤â¹â³ÛÇ§Äê¤µ¤ì¤Æ¤·¤Þ¤¦¤Î¤Ç¡¢FLG4¤òÈ½ÃÇ¤·¤Æ²óÈò
           IF  RECE02-FLG(4)  =  ZERO
             IF   RECE02-ZAITAKU  NOT =  SPACE
             AND  RECE02-ZAITAKU  NOT =  "1"
               IF  RECE02-FTNMONEY (1)  NOT =  ZERO
                 MOVE  RECE02-FTNMONEY (1)     TO  MF100-KOGAKU
               ELSE
                 COMPUTE  MF100-KOGAKU  =  RECE02-TOTALTEN (1)
                                        *  RECE02-KYURATE  /  10
               END-IF
             END-IF
           END-IF
      *=== ÆÃ¼À¡Ü957Åù¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) end
      *
      *    Ä¹´üÊÔ½¸
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) start
      *     IF     FLG-TYOKI             =      1   AND
      *            WRK-SEIKYUGK-G        >  10000
           IF     FLG-TYOKI             =      1
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) start
           AND    WRK-SEIKYUGK-G       >=  10000
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) end
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) end
             MOVE    1                 TO  MF100-TYOKI
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) start
      *       MOVE    10000             TO  WRK-SEIKYUGK-G
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) start
      *       IF   WRK-SEIKYUGK-G        >  10000
      *         MOVE    10000           TO  WRK-SEIKYUGK-G
      *       END-IF
             MOVE    10000             TO  WRK-SEIKYUGK-G
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) end
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) end
             MOVE    ZERO              TO  MF100-TOTALTEN
      *=== ¹â³Û¡ÜÄ¹´ü¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) start
             MOVE    ZERO              TO  MF100-KOGAKU
      *=== ¹â³Û¡ÜÄ¹´ü¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) end
             IF      MF100-FTNMONEY     >  10000
               MOVE  10000             TO  MF100-FTNMONEY
             END-IF
      *=== °ìÉôÉéÃ´¶â¤¬Ä¹´ü¤Î¾å¸Â³Û¤òÄ¶¤¨¤ë¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) start
             IF      MF100-ETCFTNMONEY  >  10000
               MOVE  10000             TO  MF100-ETCFTNMONEY
             END-IF
      *=== °ìÉôÉéÃ´¶â¤¬Ä¹´ü¤Î¾å¸Â³Û¤òÄ¶¤¨¤ë¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) end
           END-IF
      *---(01.00.05) LINE ADD START ------------------------------------
      *    Ä¹´ü¾å°Ì
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) start
      *     IF     FLG-TYOKI             =      2   AND
      *            WRK-SEIKYUGK-G        >  20000
           IF     FLG-TYOKI             =      2
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) start
           AND    WRK-SEIKYUGK-G       >=  20000
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) end
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) end
             MOVE    1                 TO  MF100-TYOKI
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) start
      *       MOVE    20000             TO  WRK-SEIKYUGK-G
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) start
      *       IF   WRK-SEIKYUGK-G        >  20000
      *         MOVE    20000           TO  WRK-SEIKYUGK-G
      *       END-IF
             MOVE    20000             TO  WRK-SEIKYUGK-G
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) end
      *=== ¼ÂÆü¿ô1Æü¤ÏÄ¹´ü¤È¤Ê¤é¤Ê¤¤¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) end
             MOVE    ZERO              TO  MF100-TOTALTEN
      *=== ¹â³Û¡ÜÄ¹´ü¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) start
             MOVE    ZERO              TO  MF100-KOGAKU
      *=== ¹â³Û¡ÜÄ¹´ü¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) end
             IF      MF100-FTNMONEY     >  20000
               MOVE  20000             TO  MF100-FTNMONEY
             END-IF
      *=== °ìÉôÉéÃ´¶â¤¬Ä¹´ü¤Î¾å¸Â³Û¤òÄ¶¤¨¤ë¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) start
             IF      MF100-ETCFTNMONEY  >  20000
               MOVE  20000             TO  MF100-ETCFTNMONEY
             END-IF
      *=== °ìÉôÉéÃ´¶â¤¬Ä¹´ü¤Î¾å¸Â³Û¤òÄ¶¤¨¤ë¤Î¤ò½¤Àµ by Yoshikawa(2009/10/05) end
           END-IF
      *---(01.00.05) LINE ADD END   ------------------------------------
      *
      *    ·ë³Ë¡¦Àº¿ÀÊÔ½¸
           IF     MF100-KESE-FLG    NOT =  SPACE
             MOVE    ZERO               TO  MF100-TOTALTEN
           END-IF
      *
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) start
      *      ºßÁí¿Ç¡¦ºß°åÁí¤«
             IF  RECE02-ZAITAKU  NOT =  1
               PERFORM  960-SRYACT-SET-SEC
             END-IF
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) end
      *
      *=== ¹â³Û¡ÜÄ¹´ü¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) start
      **---(01.00.04) LINE ADD START ------------------------------------
      **    ¹â³ÛÎÅÍÜÈñ¥Á¥§¥Ã¥¯¡ÊÆþ±¡¤Î¤ß¡Ë
      **=== ³°Íè¤â¹â³Û¸ÂÅÙ³Û¤ò°õ»ú¤¹¤ë by Yoshikawa(2012/04/09) start
      **     IF  RECE02-NYUGAIKBN  =  "1"
      **=== ³°Íè¤â¹â³Û¸ÂÅÙ³Û¤ò°õ»ú¤¹¤ë by Yoshikawa(2012/04/09) end
      *       IF   RECE02-ZAITAKU  NOT =  SPACE
      *       AND  RECE02-ZAITAKU  NOT =  "1"
      *         IF  RECE02-FTNMONEY (1)  NOT =  ZERO
      *           MOVE  RECE02-FTNMONEY (1)     TO  MF100-KOGAKU
      *         ELSE
      *           COMPUTE  MF100-KOGAKU  =  RECE02-TOTALTEN (1)
      *                                  *  RECE02-KYURATE  /  10
      *         END-IF
      **---(01.00.05) LINE ADD START ------------------------------------
      **       ELSE
      **           COMPUTE  MF100-KOGAKU  =  RECE02-TOTALTEN (1)
      **                                  *  RECE02-KYURATE  /  10
      **---(01.00.05) LINE ADD END   ------------------------------------
      *       END-IF
      **=== ³°Íè¤â¹â³Û¸ÂÅÙ³Û¤ò°õ»ú¤¹¤ë by Yoshikawa(2012/04/09) start
      **     END-IF
      **=== ³°Íè¤â¹â³Û¸ÂÅÙ³Û¤ò°õ»ú¤¹¤ë by Yoshikawa(2012/04/09) end
      **---(01.00.04) LINE ADD END   ------------------------------------
      *=== ¹â³Û¡ÜÄ¹´ü¤Î°õ»ú½¤Àµ by Yoshikawa(2012/07/12) end
      *
      *    ÊÝ¸±¸ÂÅÙ³ÛÈ½Äê
           IF  RECE02-FTNMONEY(1)       <  WRK-SEIKYUGK-G  AND
               RECE02-FTNMONEY(1)       >  ZERO
             MOVE  RECE02-FTNMONEY(1)  TO  WRK-SEIKYUGK-G
           END-IF
      *
      *    ·ï¿ô²Ã»»¾ì½ê¤òÈ½Äê
           IF    MF100-TOTALTEN         =  ZERO  OR
                 RECE02-RJNHKNNUM   NOT =  SPACE OR
      *---(01.00.10) LINE ADD START ------------------------------------
                 MF100-HKNNUM           =  "039" OR
                 MF100-HKNNUM           =  "040" OR
      *---(01.00.10) LINE ADD END   ------------------------------------
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) start
      *           RECE02-AGE            >=  70
                 RECE02-AGE            >=  70    OR
                 MF100-ZAITAKU          =  "1"
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) end
             IF  RECE02-RJNHKNNUM   NOT =  SPACE
      *---(01.00.10) LINE ADD START ------------------------------------
             OR  MF100-HKNNUM           =  "039"
             OR  MF100-HKNNUM           =  "040"
      *---(01.00.10) LINE ADD END   ------------------------------------
               MOVE     5              TO  MF100-KASAN-FLG
             ELSE
               MOVE     4              TO  MF100-KASAN-FLG
             END-IF
             MOVE    ZERO              TO  MF100-TOTALTEN
             MOVE    WRK-SEIKYUGK-G    TO  MF100-SEIKYUGK
           ELSE
             COMPUTE  MF100-SEIKYUGK   ROUNDED = WRK-KESE
      *---(01.00.04) LINE ADD START ------------------------------------
      *       EVALUATE  MF100-KYURATE
      *       WHEN 10
      *         MOVE     3              TO  MF100-KASAN-FLG
      *       WHEN 20
      *         MOVE     2              TO  MF100-KASAN-FLG
      *       WHEN OTHER
      *         MOVE     1              TO  MF100-KASAN-FLG
      *       END-EVALUATE
             IF  MF100-KOGAKU  NOT =  ZERO
               MOVE     3              TO  MF100-KASAN-FLG
             ELSE
               EVALUATE  MF100-KYURATE
               WHEN 20
                 MOVE     2            TO  MF100-KASAN-FLG
               WHEN OTHER
                 MOVE     1            TO  MF100-KASAN-FLG
               END-EVALUATE
             END-IF
      *---(01.00.04) LINE ADD END   ------------------------------------
           END-IF
      *    °ìÈÌ´µ¼ÔÍÑ¶èÊ¬ÀßÄê
           MOVE         2              TO  MF100-KBN
      *
      *    ¹ç·×¥Õ¥¡¥¤¥ëÍÑ¤Ë¥Ç¡¼¥¿ÂàÈò
           INITIALIZE   WRK-TAIHI-TBL
           MOVE  MF100-FTNJANUM        TO  WRK-T-FTNJANUM
           MOVE  MF100-TOTALTEN        TO  WRK-T-TOTALTEN
      *---(01.00.04) LINE ADD START ------------------------------------
           MOVE  MF100-KOGAKU          TO  WRK-T-KOGAKU
      *---(01.00.04) LINE ADD END   ------------------------------------
           MOVE  MF100-SEIKYUGK        TO  WRK-T-SEIKYUGK
           MOVE  MF100-FTNMONEY        TO  WRK-T-ITBFTN
           MOVE  MF100-KASAN-FLG       TO  WRK-T-KASAN-FLG
      *
           IF       FLG-ERR                    =   ZERO
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
           AND      FLG-ERR2                   =   ZERO
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
             WRITE    MF100-REC 
             ADD      1                 TO    CNT-MF100
      *
      *    ¹ç·×ÍÑ¥Õ¥¡¥¤¥ëÊÔ½¸
             PERFORM  2002-GOKEI-HEN-SEC
      *
           ELSE
             DISPLAY "½õÀ®ÂÐ¾Ý³°´µ¼ÔÈÖ¹æ="  RECE02-PTNUM
                     "ÅÀ¿ô="                RECE02-TOTALTEN(1)
                     "°ìÉôÉéÃ´¶â"           MF100-FTNMONEY
                     "ÉéÃ´³ä¹ç="            MF100-KYURATE
                     "¸øÈñÈÖ¹æ="            MF100-KOHNUM
                     "¿ÇÎÅÇ¯·î="            MF100-SRYYM
           END-IF
      *
           .
       20011-SYUKEI-EXT.
           EXIT.
      **
      *****************************************************************
      *    ¹ç·×¥Õ¥¡¥¤¥ëÊÔ½¸½èÍý
      *****************************************************************
       2002-GOKEI-HEN-SEC          SECTION.
      *
      *    ¹ç·×¥Õ¥¡¥¤¥ëÊÔ½¸
           INITIALIZE  MF100-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE     RECE02-HOSPID     TO    MF100-HOSPID
           MOVE     SPA-HOSPNUM       TO    MF100-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE     WRK-T-FTNJANUM    TO    MF100-FTNJANUM
           MOVE     1                 TO    MF100-KBN
      *    °ì»þ¥Õ¥¡¥¤¥ëÆÉ¤ß¹þ¤ß
           PERFORM  800-SKTTMP-READ-SEC
      *
           MOVE     WRK-T-KASAN-FLG   TO    IDX1
           ADD      1                 TO    MF100-GKENSU(IDX1)
                                            MF100-TOTAL-KENSU
           ADD      WRK-T-ITBFTN      TO    MF100-GITBFTN(IDX1)
      *=== ¾ÃÈñÀÇ²þÀµÂÐ±þ by Yoshikawa(2014/03/14) start
      *     ADD      210               TO    MF100-GTESURYO(IDX1)
      *    ÀÁµá»öÌ³¼ê¿ôÎÁ
           IF  LNK-PRTKANRI-SRYYM  >=  WRK-CONS-201403
             ADD    216               TO    MF100-GTESURYO(IDX1)
           ELSE
             ADD    210               TO    MF100-GTESURYO(IDX1)
           END-IF
      *=== ¾ÃÈñÀÇ²þÀµÂÐ±þ by Yoshikawa(2014/03/14) end
      *
      *---(01.00.04) LINE ADD START ------------------------------------
      *     EVALUATE  IDX1
      *     WHEN 1
      *     WHEN 2
      *     WHEN 3
      *       ADD   WRK-T-TOTALTEN     TO    MF100-GTENSU(IDX1)
      *       ADD   WRK-T-SEIKYUGK     TO    MF100-GTENSU(4)
      *     WHEN 4
      *     WHEN 5
      *       ADD   WRK-T-SEIKYUGK      TO   MF100-GTENSU(IDX1)
      *     END-EVALUATE
           EVALUATE  IDX1
           WHEN 1
           WHEN 2
             ADD   WRK-T-TOTALTEN     TO    MF100-GTENSU(IDX1)
             ADD   WRK-T-SEIKYUGK     TO    MF100-GTENSU(4)
           WHEN 3
             ADD   WRK-T-KOGAKU       TO    MF100-GTENSU(IDX1)
             ADD   WRK-T-SEIKYUGK     TO    MF100-GTENSU(4)
           WHEN 4
           WHEN 5
             ADD   WRK-T-SEIKYUGK      TO   MF100-GTENSU(IDX1)
           END-EVALUATE
      *---(01.00.04) LINE ADD END   ------------------------------------
      *
           IF      FLG-MF100  =  1
                   WRITE    MF100-REC
           ELSE
                   REWRITE  MF100-REC
           END-IF
      *
           .
       2002-GOKEI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £²£´£³½é¿Ç°ìÉôÉéÃ´¶âÁêÅö³Û½¸·×½èÍý
      *****************************************************************
       2002-SYOSIN-CHK-SEC  SECTION.
      *
      *    ½é¿Ç¥Á¥§¥Ã¥¯
      *    Æþ±¡¤Ï¿ÇÎÅ²ñ·×¤è¤êÈ½Äê
           MOVE   ZERO                  TO  FLG-SYOSIN
           IF     SYU-NYUGAIKBN   =   "1"
             INITIALIZE        SRYACCT-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      ****** 05/09/14 yamaguchi UPD
      **       MOVE     PATH-TBL-SRYACCT-KEY3    TO  WRK-SRYACCT-PATH
      *       MOVE     PATH-TBL-SRYACCT-KEY14    TO  WRK-SRYACCT-PATH
             MOVE     "key14"                  TO  WRK-SRYACCT-PATH
      *---(01.00.08) LINE ADD END   ------------------------------------
      *****
      *---(01.00.08) LINE ADD START ------------------------------------
      *       MOVE     SYU-HOSPID               TO  ACCT-HOSPID
             MOVE     SPA-HOSPNUM              TO  ACCT-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
             MOVE     SYU-NYUGAIKBN            TO  ACCT-NYUGAIKBN
             MOVE     SYU-PTID                 TO  ACCT-PTID
      ***** 05/09/14 yamaguchi DEL
      *       MOVE     SYU-SRYKA                TO  ACCT-SRYKA
      *****
             MOVE     SYU-SRYYMD(1:6)          TO  ACCT-SRYYM
             MOVE     "11"                     TO  ACCT-SRYKBN
             PERFORM  900-SRYACCT-SELECT-SEC
             MOVE     SYU-SKYSTYMD(7:2) TO  IDX-STG(1:2)
             MOVE     SYU-SKYEDYMD(7:2) TO  IDX-EDG(1:2)
             DISPLAY  "ÀÁµá³«»ÏÆü="  SYU-SKYSTYMD
             DISPLAY  "ÀÁµá½ªÎ»Æü="  SYU-SKYEDYMD
             DISPLAY  "³«»ÏIDX="  IDX-ST
             DISPLAY  "½ªÎ»IDX="  IDX-ED
             PERFORM  UNTIL  FLG-SRYACCT  =   1  OR
                      FLG-SYOSIN          =   1
               PERFORM  UNTIL  IDX-ST  >  IDX-ED OR
                               IDX-ST  >  31     OR
                               FLG-SYOSIN        =   1
                 IF  ACCT-DAY(1 IDX-ST)   >   0
                   MOVE  1               TO   FLG-SYOSIN
                 END-IF
                 ADD    1                TO   IDX-ST
               END-PERFORM
               PERFORM  900-SRYACCT-FETCH-SEC
             END-PERFORM
             PERFORM  900-SRYACCT-CLOSE-SEC
      *    ³°Íè¤Ï¼õ¿ÇÍúÎò¤È¿ÇÎÅ²ñ·×¤è¤êÈ½Äê
           ELSE
             MOVE    ZERO    TO    FLG-JYURRK
             PERFORM  950-JYUSIN-SELECT-SEC
             PERFORM  UNTIL  FLG-JYURRK   =   1  OR
                      FLG-SYOSIN          =   1
               PERFORM  VARYING  IDX  FROM  1  BY  1
                        UNTIL    IDX  >    15  OR
                        JYURRK-ZAINUM(IDX)  =  ZERO OR SPACE
                 INITIALIZE        SRYACCT-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *           MOVE     PATH-TBL-SRYACCT-KEY5     TO  WRK-SRYACCT-PATH
      *           MOVE     JYURRK-HOSPID             TO  ACCT-HOSPID
                 MOVE     "key5"                    TO  WRK-SRYACCT-PATH
                 MOVE     SPA-HOSPNUM               TO  ACCT-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
                 MOVE     JYURRK-NYUGAIKBN          TO  ACCT-NYUGAIKBN
                 MOVE     JYURRK-PTID               TO  ACCT-PTID
                 MOVE     JYURRK-SRYKA              TO  ACCT-SRYKA
                 MOVE     JYURRK-SRYYMD(1:6)        TO  ACCT-SRYYM
                 MOVE     JYURRK-ZAINUM(IDX)        TO  ACCT-ZAINUM
                 PERFORM  900-SRYACCT-SELECT-SEC
                 PERFORM  900-SRYACCT-CLOSE-SEC
      ***** 05/09/14 yamaguchi DEL
      *           IF    ACCT-SRYKBN  =  "11"
      *             MOVE    1    TO    FLG-SYOSIN
      *             MOVE    15   TO    IDX
      *           END-IF
      ***** 05/09/14 yamaguchi INS
                 IF    ACCT-SRYKBN  =  "11"
                   MOVE    1    TO    FLG-SYOSIN
                   MOVE    15   TO    IDX
                 ELSE
      *
                   DISPLAY  "¾®»ù²Ê³°Íè¿ÇÎÅÎÁ"
                   DISPLAY  "´µ¼ÔÈÖ¹æ = " RECE02-PTNUM
                            "ZAINUM = " ACCT-ZAINUM
      *
                   INITIALIZE  SRYACT-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *             MOVE  ACCT-HOSPID              TO  SRY-HOSPID
                   MOVE  SPA-HOSPNUM              TO  SRY-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
                   MOVE  ACCT-NYUGAIKBN           TO  SRY-NYUGAIKBN
                   MOVE  ACCT-PTID                TO  SRY-PTID
                   MOVE  ACCT-SRYKA               TO  SRY-SRYKA
                   MOVE  ACCT-SRYYM               TO  SRY-SRYYM
                   MOVE  ACCT-ZAINUM              TO  SRY-ZAINUM
                   MOVE  1                        TO  SRY-RENNUM
                   PERFORM  920-SRYACT-SET-SEC
      *
                   IF  SRY-SRYCD(1)  =  "113003510" OR "113003710"
                   OR  SRY-SRYCD(2)  =  "113003510" OR "113003710"
                   OR  SRY-SRYCD(3)  =  "113003510" OR "113003710"
                   OR  SRY-SRYCD(4)  =  "113003510" OR "113003710"
                   OR  SRY-SRYCD(5)  =  "113003510" OR "113003710"
      *
                     DISPLAY  "SRY-SRYCD(1) = " SRY-SRYCD(1)
      *
                     MOVE  1                      TO  FLG-SYOSIN
                     MOVE  15                     TO  IDX
                   END-IF
                 END-IF
      *****
               END-PERFORM
               PERFORM  950-JYUSIN-FETCH-SEC
             END-PERFORM
             PERFORM  950-JYUSIN-CLOSE-SEC
           END-IF
      *
      *    ½é¿Ç¤Î¥Ç¡¼¥¿¤Î»þ¤Î¤ß¡¢½é¿Ç»þ°ìÉôÉéÃ´¶âÁêÅö³Û¤ò»»½Ð
           IF    FLG-SYOSIN   =   1
             MOVE    ZERO    TO    WRK-SEIKYUGK
             PERFORM  VARYING  IDX  FROM  1  BY  1
                      UNTIL    IDX  >    4
               IF    SYU-KOH-HKNNUM(IDX) = "243"
                 IF    IDX  =  1
                   IF  MF100-RJNHKNNUM  =  SPACE
                     MOVE    SYU-SYUCOMPFTN-ENTANI TO    WRK-SEIKYUGK
                   ELSE
                     MOVE    SYU-KOH-COMPFTN-ENTANI(1)
                                                   TO    WRK-SEIKYUGK
                   END-IF
                 ELSE
                   MOVE  SYU-KOH-COMPFTN-ENTANI(IDX - 1)
                                                   TO  WRK-SEIKYUGK
                 END-IF
               END-IF
             END-PERFORM
             IF    WRK-SEIKYUGK    >    580
               ADD    580               TO    WRK-ETC-SYOSINFTN
             ELSE
               ADD    WRK-SEIKYUGK      TO    WRK-ETC-SYOSINFTN
             END-IF
           END-IF
      *
           .
       2002-SYOSIN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¸ÄÊÌÈ¯¹Ô»þ¤ÎÊÝ¸±¼ÔÈÖ¹æ(»ÔÄ®Â¼ÈÖ¹æ)¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       200111-HKNJANUM-CHK-SEC                SECTION.
      *
           INITIALIZE      WRK-HKNJANUM
           MOVE    "01"                     TO  WRK-HKNJANUM(1:2)
           MOVE    WRK-KOBETUCITYNUM(1:3)   TO  WRK-HKNJANUM(3:3)
      *
           IF  WRK-PARA-SYORIFLG       =   "1"
               AND FLG-SYORI           =    1
               AND FLG-ERR             =   ZERO
      *
               DISPLAY "¥Á¥§¥Ã¥¯ÍÑÊÝ¸±¼ÔÈÖ¹æ="  WRK-HKNJANUM
               MOVE    1       TO      FLG-ERR
               PERFORM VARYING IDXX    FROM    1   BY  1
                       UNTIL   IDXX    >   WRK-CONS-PARA-MAX
                       OR      TBL-PARA-HKNJANUM(IDXX)  =   SPACE
                   IF      WRK-HKNJANUM(1:5)
                                   =   TBL-PARA-HKNJANUM(IDXX)(1:5)  OR
                         ( WRK-HKNJANUM(1:3)  =  "014"   AND
                           TBL-PARA-HKNJANUM(IDXX)(1:5)  =  "01400" )
                       MOVE    ZERO                TO  FLG-ERR
                       MOVE    WRK-CONS-PARA-MAX   TO  IDXX
                   END-IF
               END-PERFORM 
           END-IF
      *
           .
       200111-HKNJANUM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ä¢É¼¥Õ¥¡¥¤¥ë½ÐÎÏ½èÍý
      *****************************************************************
       2002-PRINT-SEC                SECTION.
      *
      *
           OPEN     INPUT       MF100-FILE
      *
           MOVE     ZERO        TO       FLG-PRINT
      *
      *    °ì»þ¥Õ¥¡¥¤¥ëÆÉ¹þ
           PERFORM  900-TMP-READ-SEC
      *
           PERFORM  UNTIL     FLG-PRINT   =  1
      *
      *    Ä¢É¼ÊÔ½¸<¸«½Ð¤·>½èÍý
               PERFORM  310-HEAD-HEN-SEC
      *    Ä¢É¼ÊÔ½¸<ÌÀºÙ>½èÍý
               PERFORM  320-BODY-HEN-SEC
      *    Ä¢É¼°õºþ½èÍý
               PERFORM  330-PRINT-OUT-SEC
           END-PERFORM
      *
           CLOSE    MF100-FILE
      *
           .
       2002-PRINT-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ä¢É¼ÊÔ½¸<¥Ø¥Ã¥À¡¼Éô>½èÍý
      *****************************************************************
       310-HEAD-HEN-SEC          SECTION.
      *
      *
           ADD     1    TO    CNT-PAGE
      *
           INITIALIZE                             SC07
      *
      *    ÂÐ¾ÝÇ¯·î
           MOVE    WRK-SRYYMWH               TO   SC07-PRTYM
      *
      *    ÀÁµáÇ¯·îÆü
           MOVE    WRK-SEIYMDWH              TO   SC07-SEIYMD
      *
      *    °åÎÅµ¡´Ø¥³¡¼¥É
           MOVE     SYS-1001-HOSPCD          TO   SC07-HOSPCD
      *---(01.00.08) LINE ADD START ------------------------------------
      *    °åÎÅµ¡´Ø½»½ê
      *     MOVE     SYS-1002-ADRS            TO   SC07-ADRS
      *    °åÎÅµ¡´ØÌ¾
      *     MOVE     SYS-1001-HOSPNAME        TO   SC07-HOSPNAME
      *    °åÎÅµ¡´Ø½»½ê
           MOVE    WRK-HOSPADRS              TO  SC07-ADRS
      *=== °åÎÅµ¡´Ø¾ðÊóÊÔ½¸½¤Àµ by Yoshikawa(2012/12/13) start
           INSPECT SC07-ADRS                 REPLACING ALL "  " BY "¡¡"
      *=== °åÎÅµ¡´Ø¾ðÊóÊÔ½¸½¤Àµ by Yoshikawa(2012/12/13) end
      *    °åÎÅµ¡´ØÌ¾
           MOVE    WRK-HOSPNAME              TO  SC07-HOSPNAME
      *=== °åÎÅµ¡´Ø¾ðÊóÊÔ½¸½¤Àµ by Yoshikawa(2012/12/13) start
           INSPECT SC07-HOSPNAME             REPLACING ALL "  " BY "¡¡"
      *=== °åÎÅµ¡´Ø¾ðÊóÊÔ½¸½¤Àµ by Yoshikawa(2012/12/13) end
      *---(01.00.08) LINE ADD END   ------------------------------------
      *    ³«Àß¼ÔÌ¾
           MOVE     SYS-1001-KAISETUNAME     TO   SC07-KAISETU
      *---(01.00.08) LINE ADD START ------------------------------------
      *    ÅÅÏÃÈÖ¹æ
      *     MOVE     SYS-1002-TEL             TO   SC07-TEL
      *    ÅÅÏÃÈÖ¹æ
           MOVE     WRK-HOSPTEL              TO   SC07-TEL
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *    »ÔÄ®Â¼Ì¾
           INITIALIZE                             WRK-HKNJANUM
           MOVE  "01"                        TO   WRK-HKNJANUM(1:2)
           MOVE  MF100-FTNJANUM(1:3)         TO   WRK-HKNJANUM(3:3)
           PERFORM  920-HKNJAINF-SET-SEC
           IF      HKNJA-HKNJANAME           =    SPACE
             MOVE    "Ä¹  ÍÍ"                TO   SC07-CITYNAME(13:6)
           ELSE
      *---(01.00.06) LINE ADD START ------------------------------------
      *       STRING  HKNJA-HKNJANAME         DELIMITED  BY SPACE
      *               "Ä¹  ÍÍ"          DELIMITED  BY SIZE
      *               INTO                    SC07-CITYNAME
      *       END-STRING
             IF  HKNJA-HKNJANAME(1:16)       =    "¶õÃÎÃæÉô¹­°èÏ¢¹ç"
                 OR  HKNJA-HKNJANAME(1:16)   =    "ÂçÀãÃÏ¶è¹­°èÏ¢¹ç"
               STRING  HKNJA-HKNJANAME(19:)         DELIMITED  BY "¡Í"
                       "Ä¹  ÍÍ"          DELIMITED  BY SIZE
                       INTO                    SC07-CITYNAME
               END-STRING
             ELSE
               STRING  HKNJA-HKNJANAME         DELIMITED  BY SPACE
                       "Ä¹  ÍÍ"          DELIMITED  BY SIZE
                       INTO                    SC07-CITYNAME
               END-STRING
             END-IF
      *---(01.00.06) LINE ADD END ------------------------------------
           END-IF
      *
      *    ¹ç·×ÍÑ¥Õ¥¡¥¤¥ë»þ¤ÎÊÔ½¸
           IF  MF100-KBN                     =    1
             MOVE     "SC0107.red"           TO   WRK-PRTID
             IF  MF100-TOTAL-KENSU           >    10
               MOVE   1                      TO   FLG-SYOKEI
             ELSE
               MOVE   ZERO                   TO   FLG-SYOKEI
             END-IF
             PERFORM  VARYING  IDX1  FROM  1  BY  1
                      UNTIL    IDX1  >     5
               MOVE   MF100-GKENSU(IDX1)     TO   WRK-Z5
               MOVE   WRK-Z5                 TO   SC07-GKENSU(IDX1)
               MOVE   MF100-GTENSU(IDX1)     TO   WRK-Z9
               MOVE   WRK-Z9                 TO   SC07-GTENSU(IDX1)
               MOVE   MF100-GITBFTN(IDX1)    TO   WRK-Z7
               MOVE   WRK-Z7                 TO   SC07-GITBFTN(IDX1)
               MOVE   MF100-GTESURYO(IDX1)   TO   WRK-Z6
               MOVE   WRK-Z6                 TO   SC07-GTESURYO(IDX1)
             END-PERFORM
      *    °ì»þ¥Õ¥¡¥¤¥ëÆÉ¹þ
             PERFORM  900-TMP-READ-SEC
           ELSE
             MOVE     "SC0108.red"           TO   WRK-PRTID
           END-IF
      *
           .
       310-HEAD-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ä¢É¼ÊÔ½¸<ÌÀºÙ¹Ô>½èÍý
      *****************************************************************
       320-BODY-HEN-SEC      SECTION.
      *
           INITIALIZE          SUM-AREA
           MOVE    KEY-NEW     TO   KEY-OLD 
      *
           PERFORM  VARYING    IDX1  FROM  1  BY  1
                    UNTIL      IDX1  >    10
                    OR         KEY-NEW  NOT    =   KEY-OLD
                    OR         FLG-PRINT       =   1
      * 
      *    ¿ÇÎÅÇ¯·î
             MOVE    MF100-SRYYM         TO  WRK-SYMD (1:6)
             MOVE    "01"                TO  WRK-SYMD (7:2)
             PERFORM 31012-SEIWA-HEN-SEC
             MOVE    WRK-HENYMDG(5:4)    TO  SC07-SRYYM(IDX1)(1:4)
             MOVE    WRK-HENYMDG(11:4)   TO  SC07-SRYYM(IDX1)(5:4)
      *    ¼õµë¼ÔÈÖ¹æ
             MOVE    MF100-JKYSNUM       TO  WRK-MAE-INPUT
             PERFORM 2009-HENKAN-SEC
             MOVE     ZERO     TO    IDX3
             PERFORM  VARYING  IDX2  FROM   1  BY  2
                      UNTIL    IDX2  >      14 OR
                      WRK-OUT-INPUT(IDX2:2) =  SPACE
               ADD    2        TO            IDX3
             END-PERFORM
             IF    IDX3    >    ZERO
               COMPUTE  IDX2  =  15 - IDX3
               MOVE  WRK-OUT-INPUT(1:IDX3)
                               TO  SC07-JKYSNUM(IDX1)(IDX2:IDX3)
             END-IF
      *
      *    ¼õµë¼ÔÈÖ¹æ¤Î¶õÇò¤ò£°¤ËÃÖ¤­´¹¤¨¤ë
           INSPECT SC07-JKYSNUM(IDX1)  REPLACING  ALL "  "  BY  "£°"
      *
      *    »áÌ¾
             MOVE    MF100-NAME          TO  SC07-NAME(IDX1)
      *    Æþ³°¶èÊ¬
             IF      MF100-NYUGAIKBN     =   "1"
               MOVE  "¡û"                TO  SC07-NYUGAIKBN(IDX1 1)
             ELSE
               MOVE  "¡û"                TO  SC07-NYUGAIKBN(IDX1 2)
             END-IF
      *
      *    ÅÀ¿ô¡¦ÀÁµá¶â³Û¡¦°ìÉôÉéÃ´¶â
      *---(01.00.04) LINE ADD START ------------------------------------
      *       MOVE    MF100-TOTALTEN    TO  WRK-Z7
      *       EVALUATE  MF100-KYURATE
      *       WHEN 10
      *         MOVE    WRK-Z7          TO  SC07-TENSU9(IDX1)
      *       WHEN 20
      *         MOVE    WRK-Z7          TO  SC07-TENSU8(IDX1)
      *       WHEN OTHER
      *         MOVE    WRK-Z7          TO  SC07-TENSU7(IDX1)
      *       END-EVALUATE
      *    ¹â³ÛÎÅÍÜÈñ
             IF  MF100-KOGAKU  NOT =  ZERO
               MOVE  MF100-KOGAKU      TO  WRK-Z7
               MOVE  WRK-Z7            TO  SC07-TENSU9(IDX1)
             ELSE
               MOVE    MF100-TOTALTEN  TO  WRK-Z7
               EVALUATE  MF100-KYURATE
               WHEN 20
                 MOVE    WRK-Z7        TO  SC07-TENSU8(IDX1)
               WHEN OTHER
                 MOVE    WRK-Z7        TO  SC07-TENSU7(IDX1)
               END-EVALUATE
             END-IF
      *---(01.00.04) LINE ADD END   ------------------------------------
      *
             IF      MF100-RJNHKNNUM   NOT  =  SPACE
      *---(01.00.10) LINE ADD START ------------------------------------
             OR      MF100-HKNNUM           =  "039"
             OR      MF100-HKNNUM           =  "040"
      *---(01.00.10) LINE ADD END   ------------------------------------
               MOVE  MF100-SEIKYUGK    TO  WRK-Z7
               MOVE  WRK-Z7            TO  SC07-RJN(IDX1)
             ELSE
               MOVE  MF100-SEIKYUGK    TO  WRK-Z7
               MOVE  WRK-Z7            TO  SC07-ZNK(IDX1)
      *=== ¹â³Û¤ÈÁ°´ü¤ÏÁ°´ü¹âÎð¼Ô¤Î¤ß°õ»ú by Yoshikawa(2013/03/18) start
      *        ¸ÂÅÙ³ÛÍó¤Ë¤âÃÍ¤¬¤¢¤ë¾ì¹ç¤Ï¡¢Á°´ü¹âÎð¼ÔÍó¤òÍ¥Àè
               IF  MF100-KOGAKU  NOT =  ZERO
      *=== 70ºÐÌ¤Ëþ¤Ç¹â³Û¤Î¾ì¹ç¤Î°õ»ú½¤Àµ by Yoshikawa(2013/06/10) start
               AND MF100-SEIKYUGK  NOT =  ZERO
      *=== 70ºÐÌ¤Ëþ¤Ç¹â³Û¤Î¾ì¹ç¤Î°õ»ú½¤Àµ by Yoshikawa(2013/06/10) end
                 MOVE  SPACE           TO  SC07-TENSU9(IDX1)
                 MOVE  ZERO            TO  MF100-KOGAKU
               END-IF
      *=== ¹â³Û¤ÈÁ°´ü¤ÏÁ°´ü¹âÎð¼Ô¤Î¤ß°õ»ú by Yoshikawa(2013/03/18) end
             END-IF
      *
             IF    (MF100-RJNHKNNUM  NOT   =  SPACE  OR
      *---(01.00.10) LINE ADD START ------------------------------------
                    MF100-HKNNUM           =  "039"  OR
                    MF100-HKNNUM           =  "040"  OR
      *---(01.00.10) LINE ADD END   ------------------------------------
                    MF100-AGE          >=  70)       AND
      *---(01.00.05) LINE ADD START ------------------------------------
      *              MF100-KYURATE       =  20
                    (MF100-KYURATE      =  20        OR
                     MF100-KYURATE      =  30)
      *---(01.00.05) LINE ADD END   ------------------------------------
               MOVE  "¡û"              TO  SC07-KOHKBN(IDX1 1)
             END-IF
      *
      *---(01.00.05) LINE ADD START ------------------------------------
      *       IF     MF100-ZAITAKU  NOT  =  SPACE
             IF     MF100-ZAITAKU  =  "1"
      *---(01.00.05) LINE ADD END   ------------------------------------
               MOVE  "¡û"              TO  SC07-KOHKBN(IDX1 2)
      *=== ¡Öºß¡×¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡Ö³ä¡×¤Ë¡ûÉÔÍ× by Uchida(2009/05/22) start
               MOVE  "¡¡"              TO  SC07-KOHKBN(IDX1 1)
      *=== ¡Öºß¡×¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡Ö³ä¡×¤Ë¡ûÉÔÍ× by Uchida(2009/05/22) end
             END-IF
      *
             IF     MF100-TYOKI         =  1
               MOVE  "¡û"              TO  SC07-KOHKBN(IDX1 3)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) start
               MOVE  "¡¡"              TO  SC07-KOHKBN(IDX1 1)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) end
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) start
      *       END-IF
             ELSE
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) end
      *
             EVALUATE  MF100-KESE-FLG
             WHEN  "010"
             WHEN  "011"
               MOVE  "¡û"              TO  SC07-KOHKBN(IDX1 4)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) start
               MOVE  "¡¡"              TO  SC07-KOHKBN(IDX1 1)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) end
             WHEN  "020"
             WHEN  "021"
               MOVE  "¡û"              TO  SC07-KOHKBN(IDX1 5)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) start
               MOVE  "¡¡"              TO  SC07-KOHKBN(IDX1 1)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) end
             WHEN  "015"
             WHEN  "016"
               MOVE  "¡û"              TO  SC07-KOHKBN(IDX1 6)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) start
               MOVE  "¡¡"              TO  SC07-KOHKBN(IDX1 1)
      *=== ³ä°Ê³°¤Ë¡û¤¬¤¢¤ë¾ì¹ç¡¢³ä¤Ë¡ûÉÔÍ× by Yoshikawa(2009/07/10) end
             END-EVALUATE
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) start
             END-IF
      *=== ¾å¸Â³Û¤¬Äã¤¤Êý¤Ë¡û¤ò°õ»ú by Yoshikawa(2009/12/17) end
      *
             IF    (MF100-KOHNUM  =  "243"  AND
                    MF100-ETCFTNMONEY   >  0) OR
                   (MF100-KOHNUM  =  "543")
               MOVE  MF100-ETCFTNMONEY TO  WRK-Z6
               MOVE  "¡û"              TO  SC07-MARU(IDX1)
             ELSE
               MOVE  MF100-FTNMONEY    TO  WRK-Z6
             END-IF
             MOVE  WRK-Z6              TO  SC07-ITBFTN(IDX1)
             IF     MF100-KOHNUM  =  "143"  OR
                    MF100-KOHNUM  =  "243"
      *
      *  °ìÉôÉéÃ´¶âÍó¤Ë¶â³Û¤òµ­ºÜ¤¹¤ë»þ¤Î¤ß¢þ¤ò¤¹¤ë
               IF  MF100-FTNMONEY      >   ZERO  OR
                   MF100-ETCFTNMONEY   >   ZERO
                 MOVE    "¢þ"          TO  SC07-FTNMARU(IDX1 1)
               END-IF
             ELSE
               MOVE  "¡û"              TO  SC07-FTNMARU(IDX1 2)
             END-IF
      *---(01.00.03) LINE ADD START ------------------------------------
      *    °°Àî»Ô¤Ç½é¿Ç¤Î¾ì¹ç¤ÏÈ÷¹ÍÍó°õ»ú
      *---(01.00.05) LINE ADD START ------------------------------------
      *       IF  MF100-KOHNUM  =  "643"
             IF  MF100-SHOSAISIN  =  1
      *---(01.00.05) LINE ADD END   ------------------------------------
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) start
      **=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) start
      *         IF  MF100-FTNMONEY  =  ZERO
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) end
                 MOVE  MF100-ETCFTNMONEY  TO  WRK-Z3
                 MOVE  WRK-Z3          TO  SC07-BIKO1(IDX1)
                 MOVE  "¡û"            TO  SC07-BIKO2(IDX1)
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) start
      *         ELSE
      **=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) end
      *           MOVE  "580"           TO  SC07-BIKO1(IDX1)
      *           MOVE  "¡û"            TO  SC07-BIKO2(IDX1)
      **=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) start
      *         END-IF
      **=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) end
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) end
             END-IF
      *---(01.00.03) LINE ADD END   ------------------------------------
      *    ¾®·×²Ã»»
             MOVE    MF100-KASAN-FLG   TO  IDX2
             ADD     1                 TO  SUM-KENSU(IDX2)
      *---(01.00.04) LINE ADD START ------------------------------------
      *       EVALUATE  MF100-KYURATE
      *       WHEN 10
      *         ADD     MF100-TOTALTEN  TO  SUM-TENSU9
      *       WHEN 20
      *         ADD     MF100-TOTALTEN  TO  SUM-TENSU8
      *       WHEN OTHER
      *         ADD     MF100-TOTALTEN  TO  SUM-TENSU7
      *       END-EVALUATE
             IF  MF100-KOGAKU  NOT =  ZERO
               ADD  MF100-KOGAKU        TO  SUM-TENSU9
             ELSE
               EVALUATE  MF100-KYURATE
               WHEN 20
                 ADD     MF100-TOTALTEN  TO  SUM-TENSU8
               WHEN OTHER
                 ADD     MF100-TOTALTEN  TO  SUM-TENSU7
               END-EVALUATE
             END-IF
      *---(01.00.04) LINE ADD END   ------------------------------------
             IF     MF100-RJNHKNNUM NOT =  SPACE
      *---(01.00.10) LINE ADD START ------------------------------------
             OR     MF100-HKNNUM        =  "039"
             OR     MF100-HKNNUM        =  "040"
      *---(01.00.10) LINE ADD END   ------------------------------------
               ADD     MF100-SEIKYUGK  TO  SUM-RJN
             ELSE
               ADD     MF100-SEIKYUGK  TO  SUM-ZNK
             END-IF
             ADD    MF100-FTNMONEY     TO  SUM-ITBFTN
      *    °ì»þ¥Õ¥¡¥¤¥ëÆÉ¹þ
             PERFORM   900-TMP-READ-SEC
           END-PERFORM
      *
      *    £±£±·ï°Ê¾åÌÀºÙ¤¬Í­¤ë¾ì¹ç¤Î¤ß¾®·×ÊÔ½¸
           IF     FLG-SYOKEI     =     1
             PERFORM  VARYING  IDX1  FROM  1  BY  1
                      UNTIL    IDX1  >     5
               MOVE  SUM-KENSU(IDX1)   TO  WRK-Z5
               MOVE  WRK-Z5            TO  SC07-SKENSU(IDX1)
             END-PERFORM
             MOVE  SUM-TENSU7          TO  WRK-Z7
             MOVE  WRK-Z7              TO  SC07-STENSU7
             MOVE  SUM-TENSU8          TO  WRK-Z7
             MOVE  WRK-Z7              TO  SC07-STENSU8
             MOVE  SUM-TENSU9          TO  WRK-Z7
             MOVE  WRK-Z7              TO  SC07-STENSU9
             MOVE  SUM-ZNK             TO  WRK-Z7
             MOVE  WRK-Z7              TO  SC07-SZNK
             MOVE  SUM-RJN             TO  WRK-Z7
             MOVE  WRK-Z7              TO  SC07-SRJN
             MOVE  SUM-ITBFTN          TO  WRK-Z7
             MOVE  WRK-Z7              TO  SC07-SITBFTN
           END-IF
      *
      *
           .
       320-BODY-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ä¢É¼°õºþ½èÍý
      *****************************************************************
       330-PRINT-OUT-SEC                SECTION.
      *
      *
           INITIALIZE                  ORCSPRTAREA
           MOVE    "INS"               TO  SPRT-MODE
           MOVE    LNK-PRTKANRI-RENNUM TO  SPRT-RENNUM
           MOVE    LNK-PRTKANRI-TBL-KEY
                                       TO  SPRT-TBL-KEY
           MOVE    LNK-PRTKANRI-TBL-GROUP
                                       TO  SPRT-TBL-GROUP
           MOVE    LNK-PRTKANRI-SRYYM  TO  SPRT-SRYYM
           MOVE    LNK-PRTKANRI-SKYYMD TO  SPRT-SKYYMD
           MOVE    LNK-PRTKANRI-SHELLID 
                                       TO  SPRT-SHELLID
           MOVE    LNK-PRTKANRI-SHORI-RENNUM
                                       TO  SPRT-SHORI-RENNUM
           MOVE    LNK-PRTKANRI-PRIORITY
                                       TO  SPRT-PRIORITY
           MOVE   WRK-PRTID            TO  SPRT-PRTID
      *=== Ä¢É¼¥¿¥¤¥È¥ë½¤Àµ by Yoshikawa(2012/07/12) start
      *     MOVE    "½ÅÅÙ¿´¿È¾ã³²¼Ô°åÎÅÈñÀÁµá½ñ"
           MOVE    "½ÅÅÙ¿´¿È¾ã¤¬¤¤¼Ô°åÎÅÈñÀÁµá½ñ"
      *=== Ä¢É¼¥¿¥¤¥È¥ë½¤Àµ by Yoshikawa(2012/07/12) end
                                    TO  SPRT-TITLE
           MOVE    SC07             TO  SPRT-PRTDATA
           MOVE    LNK-PRTKANRI-TERMID TO  SPRT-TERMID
           MOVE    LNK-PRTKANRI-OPID   TO  SPRT-OPID
           MOVE    LNK-PRTKANRI-PRTNM  TO  SPRT-PRTNM
           CALL    "ORCSPRT"           USING
                                       ORCSPRTAREA
      *---(01.00.08) LINE ADD START ------------------------------------
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      SPRT-RETURN         =   ZERO
               CONTINUE
           ELSE
               MOVE    "°õºþ£Ä£Â¤Ë¹¹¿·¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿"
                                          TO  WRK-RECEERR
               PERFORM 500-ERR-HENSYU-SEC
           END-IF
           .
       330-PRINT-OUT-EXT.
           EXIT.
      *****************************************************************
      *    ¥¨¥é¡¼½ÐÎÏ½èÍý
      *****************************************************************
       500-ERR-HENSYU-SEC  SECTION.
      *
           OPEN  INPUT  RECEERR-FILE
           IF  STS-RECEERR  =  ZERO
             CONTINUE
           ELSE
             OPEN  OUTPUT  RECEERR-FILE
      *
             MOVE  WRK-RECEERR  TO  RECEERR-REC
             WRITE RECEERR-REC
           END-IF
      *
           CLOSE  RECEERR-FILE
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    À¾ÎñÆüËÜ¸ìÊÑ´¹½èÍý
      *****************************************************************
       31012-SEIWA-HEN-SEC        SECTION.
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD3    TO  WRK-HENYMDG
           INSPECT WRK-HENYMDG    REPLACING  ALL "  "  BY  "¡¡"
           .
       31012-SEIWA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½ªÎ»¡¡¡¡½èÍý
      *****************************************************************
       300-END-SEC   SECTION.
      *
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) start
      *     MOVE    "DBCLOSECURSOR"            TO  MCP-FUNC
      **---(01.00.08) LINE ADD START ------------------------------------
      **     MOVE    PATH-TBL-KOHSKY-KEY2       TO  MCP-PATH
      **     CALL    "MCPSUB"             USING
      **                                  MCPAREA
      **                                  MCPDATA-REC
      *     MOVE    "tbl_kohsky"        TO  MCP-TABLE
      *     MOVE    "key2"              TO  MCP-PATHNAME
      *     CALL    "ORCDBMAIN"         USING
      *                                 MCPAREA
      *                                 MCPDATA-REC
      *                                 SPA-AREA
      **---(01.00.08) LINE ADD END   ------------------------------------
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) end
      *
           CLOSE  MF100-FILE
           MOVE  CNT-PAGE  TO  WRK-PARA-PAGE
      *
           DISPLAY "*** SEIKYU0107 IN  "  CNT-RECE02
           DISPLAY "*** SEIKYU0107 OUT "  CNT-MF100
           DISPLAY "*** SEIKYU0107 END ***"
      *
           IF  CNT-MF100  =  0
             DISPLAY "DATA NOT FOUND. PRINT JOB CANCEL!!"
           END-IF
      *
      *    ¥¹¥Æ¥Ã¥×½ªÎ»½èÍý
           MOVE    "STE"           TO  SJOBKANRI-MODE
           INITIALIZE                  JOBKANRI-REC
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE    WRK-PARA-PAGE   TO  JOB-UPDCNT
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA
                                   JOBKANRI-REC
      *---(01.00.08) LINE ADD START ------------------------------------
                                   SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           PERFORM 900-DBDISCONNECT-SEC
           .
       300-END-EXT.
           EXIT.
      *
      *****************************************************************
      *    °ì»þ¥Õ¥¡¥¤¥ëÆÉ¹þ
      *****************************************************************
       900-TMP-READ-SEC                SECTION.
      *
           READ  MF100-FILE   NEXT
               AT  END
                   MOVE  1  TO  FLG-PRINT
               NOT  AT  END
                   MOVE  MF100-FTNJANUM       TO  KEY-N-FTNJANUM
           END-READ
           .
       900-TMP-READ-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ½¸·×¥Õ¥¡¥¤¥ëÆÉ¹þ
      *****************************************************************
       800-SKTTMP-READ-SEC             SECTION.
      *
           READ    MF100-FILE
               INVALID    KEY
                   MOVE    1           TO  FLG-MF100
               NOT INVALID  KEY
                   MOVE    ZERO        TO  FLG-MF100
           END-READ
           .
       800-SKTTMP-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸øÈñÀÁµá½ñ¥Þ¥¹¥¿ÆÉ¹þ
      *****************************************************************
       900-KOHSKY-START-SEC            SECTION.
      *
           INITIALIZE                  RECE02-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    WRK-PARA-HOSPID     TO  RECE02-HOSPID
           MOVE    SPA-HOSPNUM         TO  RECE02-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE    LNK-PRTKANRI-SRYYM  TO  RECE02-SKYYM
           MOVE    RECE02-REC          TO  MCPDATA-REC
      *
           MOVE    "DBSELECT"                 TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-KOHSKY-KEY2       TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_kohsky"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               PERFORM 900-KOHSKY-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-END
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) start
               PERFORM 900-KOHSKY-CLOSE-SEC
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) end
           END-IF
           .
       900-KOHSKY-START-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ¸øÈñÀÁµá½ñ¥Þ¥¹¥¿£Ò£Å£Á£Ä
      *****************************************************************
       900-KOHSKY-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"                  TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-KOHSKY-KEY2       TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_kohsky"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-END
               MOVE    MCPDATA-REC     TO  RECE02-REC
      *---(01.00.05) LINE ADD START ------------------------------------
      *---(01.00.03) LINE ADD START ------------------------------------
      **         IF  RECE02-KOHNUM(1) = "143" OR "243" OR "343" OR "543"
      **          OR RECE02-KOHNUM(2) = "143" OR "243" OR "343" OR "543"
      **          OR RECE02-KOHNUM(3) = "143" OR "243" OR "343" OR "543"
      **          OR RECE02-KOHNUM(4) = "143" OR "243" OR "343" OR "543"
      *         IF  RECE02-KOHNUM(1) = "143" OR "243" OR "343" OR "543"
      *                             OR "643"
      *         OR  RECE02-KOHNUM(2) = "143" OR "243" OR "343" OR "543"
      *                             OR "643"
      *         OR  RECE02-KOHNUM(3) = "143" OR "243" OR "343" OR "543"
      *                             OR "643"
      *         OR  RECE02-KOHNUM(4) = "143" OR "243" OR "343" OR "543"
      *                             OR "643"
      *---(01.00.03) LINE ADD END   ------------------------------------
               IF  RECE02-KOHNUM(1) = "143" OR "243" OR "343" OR "543"
                                   OR "643" OR "743" OR "843"
               OR  RECE02-KOHNUM(2) = "143" OR "243" OR "343" OR "543"
                                   OR "643" OR "743" OR "843"
               OR  RECE02-KOHNUM(3) = "143" OR "243" OR "343" OR "543"
                                   OR "643" OR "743" OR "843"
               OR  RECE02-KOHNUM(4) = "143" OR "243" OR "343" OR "543"
                                   OR "643" OR "743" OR "843"
      *---(01.00.05) LINE ADD END   ------------------------------------
      *        ¥Æ¥¹¥È´µ¼Ô¤Î¤È¤­¤ÏÆÉ¤ßÈô¤Ð¤¹
                   MOVE    SPACE               TO  PTINF-REC
                   INITIALIZE                      PTINF-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *             MOVE    RECE02-HOSPID       TO  PTINF-HOSPID
                   MOVE    SPA-HOSPNUM         TO  PTINF-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
                   MOVE    RECE02-PTID         TO  PTINF-PTID
                   MOVE    PTINF-REC           TO  MCPDATA-REC
                   PERFORM 800-PTINF-READ-SEC
                   IF      FLG-PTINF           =   ZERO
                   AND     PTINF-TSTPTNUMKBN   =   "1"
                       GO  TO  900-KOHSKY-READ-SEC
                   END-IF   
      *
      *        ¸ÄÊÌÈ¯¹Ô¤Ç´µ¼ÔÈÖ¹æ»ØÄê¤Î¾ì¹ç¡¢ÂÐ¾ÝÈ½Äê¤ò¹Ô¤¦
                   MOVE  ZERO                TO  FLG-ERR
                   IF      WRK-PARA-SYORIFLG   =   "1"
                   AND     FLG-SYORI           =    2
                     MOVE  1                   TO  FLG-ERR
                     PERFORM VARYING IDXX    FROM    1   BY  1
                             UNTIL   IDXX    >   WRK-CONS-PARA-MAX
                             OR      TBL-PARA-PTID(IDXX) =   ZERO
                         IF      RECE02-PTID =   TBL-PARA-PTID(IDXX)
                           MOVE    ZERO        TO  FLG-ERR
                         END-IF
                     END-PERFORM 
                   END-IF
                   DISPLAY "´µ¼ÔÈÖ¹æ=" RECE02-PTNUM
                           "ÉéÃ´¼ÔÈÖ¹æ=" RECE02-KOHFTNJANUM(1)
                           "ÊÝ¸±¼ÔÈÖ¹æ=" RECE02-HKNJANUM
      *
                   IF      FLG-ERR           =   1
                     GO  TO  900-KOHSKY-READ-SEC
                   END-IF
      *
                   ADD  1  TO  CNT-RECE02
               ELSE
                 GO  TO  900-KOHSKY-READ-SEC
               END-IF
           ELSE
               MOVE    1               TO  FLG-END
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) start
               PERFORM 900-KOHSKY-CLOSE-SEC
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) end
           END-IF
           .
       900-KOHSKY-READ-EXT.
           EXIT.
      *
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) start
      *****************************************************************
      *    ¸øÈñÀÁµá½ñ¥Þ¥¹¥¿¥¯¥í¡¼¥º
      *****************************************************************
       900-KOHSKY-CLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"       TO  MCP-FUNC
           MOVE    "tbl_kohsky"          TO  MCP-TABLE
           MOVE    "key2"                TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
           .
       900-KOHSKY-CLOSE-EXT.
           EXIT.
      *=== ¸øÈñÀÁµá¥Æ¡¼¥Ö¥ëclose°ÌÃÖÊÑ¹¹ by Yoshikawa(2011/02/16) end
      *
      *****************************************************************
      *    ´µ¼Ô¥Þ¥¹¥¿ÆÉ¹þ
      *****************************************************************
       800-PTINF-READ-SEC         SECTION.
      *
           MOVE    "DBSELECT"                 TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-PTINF-KEY         TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_ptinf"           TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               MOVE    "DBFETCH"           TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE    PATH-TBL-PTINF-KEY         TO  MCP-PATH
      *         CALL    "MCPSUB"             USING
      *                                      MCPAREA
      *                                      MCPDATA-REC
               MOVE    "tbl_ptinf"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"         USING
                                           MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-PTINF
                   MOVE    MCPDATA-REC         TO  PTINF-REC
               ELSE
                   MOVE    1                   TO  FLG-PTINF
                   INITIALIZE                  PTINF-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTINF
               INITIALIZE                  PTINF-REC
           END-IF
      *
           MOVE    "DBCLOSECURSOR"            TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-PTINF-KEY         TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_ptinf"            TO  MCP-TABLE
           MOVE    "key"                  TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"            USING
                                          MCPAREA
                                          MCPDATA-REC
                                          SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       800-PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÀÁµáÅÀ¿ô½¸·×½èÍý
      *****************************************************************
       800-SEIKYU-SEC  SECTION.
      *
      *
           IF       RECE02-RJNHKNNUM   =  SPACE
             IF     RECE02-FTNMONEY(1) >  ZERO
               MOVE   SYU-SYUCOMPFTN            TO  WRK-SEIKYUGK
             ELSE
               MOVE   SYU-SYUCOMPFTN-ENTANI     TO  WRK-SEIKYUGK
             END-IF
           ELSE
             IF     RECE02-FTNMONEY(1) >  ZERO
               MOVE   SYU-KOH-COMPFTN(1)        TO  WRK-SEIKYUGK  
             ELSE
               MOVE   SYU-KOH-COMPFTN-ENTANI(1) TO  WRK-SEIKYUGK  
             END-IF
           END-IF
      *
           PERFORM  VARYING  IDX  FROM  1  BY  1
                    UNTIL    IDX  >     4  OR
                    SYU-KOH-HKNNUM(IDX) =  SPACE
      *
      *    ¸øÈñÊ»ÍÑÈ½Äê
             EVALUATE  SYU-KOH-HKNNUM(IDX)
             WHEN "010"
             WHEN "011"
             WHEN "015"
             WHEN "016"
             WHEN "020"
             WHEN "021"
               IF  RECE02-FTNMONEY(1)        >   ZERO
                 MOVE    SYU-KOH-COMPFTN(IDX)  TO  WRK-SEIKYUGK
                 ADD     SYU-KOH-COMPFTN(IDX)  TO  WRK-KESE
               ELSE
                 MOVE    SYU-KOH-COMPFTN-ENTANI(IDX)  TO  WRK-SEIKYUGK
                 ADD     SYU-KOH-COMPFTN-ENTANI(IDX)  TO  WRK-KESE
               END-IF
               ADD     SYU-TOTAL-HKNTEN      TO  WRK-KOHTENSU
               MOVE    SYU-KOH-HKNNUM(IDX)   TO  MF100-KESE-FLG
      *=== Ä¹´üÅù¡Ü¸øÈñ½õÀ®Ìµ¤·¤Ï°õ»ú¤·¤Ê¤¤ by Yoshikawa(2008/11/25) start
      *         MOVE    ZERO                  TO  FLG-ERR
      *=== Ä¹´üÅù¡Ü¸øÈñ½õÀ®Ìµ¤·¤Ï°õ»ú¤·¤Ê¤¤ by Yoshikawa(2008/11/25) end
      *=== ³°Íè¹¹À¸Åù¤Ïµ­ºÜ¤¹¤ë by Yoshikawa(2009/01/15) start
               IF  RECE02-NYUGAIKBN  =  "2"
                 MOVE  ZERO                  TO  FLG-ERR
               END-IF
      *=== ³°Íè¹¹À¸Åù¤Ïµ­ºÜ¤¹¤ë by Yoshikawa(2009/01/15) end
             WHEN "972"
               MOVE    1                     TO  FLG-TYOKI
      *=== Ä¹´üÅù¡Ü¸øÈñ½õÀ®Ìµ¤·¤Ï°õ»ú¤·¤Ê¤¤ by Yoshikawa(2008/11/25) start
      *         MOVE    ZERO                  TO  FLG-ERR
      *=== Ä¹´üÅù¡Ü¸øÈñ½õÀ®Ìµ¤·¤Ï°õ»ú¤·¤Ê¤¤ by Yoshikawa(2008/11/25) end
      *---(01.00.05) LINE ADD START ------------------------------------
             WHEN "974"
               MOVE    2                     TO  FLG-TYOKI
      *=== Ä¹´üÅù¡Ü¸øÈñ½õÀ®Ìµ¤·¤Ï°õ»ú¤·¤Ê¤¤ by Yoshikawa(2008/11/25) start
      *         MOVE    ZERO                  TO  FLG-ERR
      *=== Ä¹´üÅù¡Ü¸øÈñ½õÀ®Ìµ¤·¤Ï°õ»ú¤·¤Ê¤¤ by Yoshikawa(2008/11/25) end
      *---(01.00.05) LINE ADD END   ------------------------------------
             END-EVALUATE
      *
      *    ·×»»ÉéÃ´¶â¤Ëº¹¤¬Í­¤ë¾ì¹ç¡¢ÃÏÊý¸øÈñ¤Î½õÀ®¤¬¤¢¤Ã¤¿¤ÈÈ½Äê¤¹¤ë
             IF     FLG-ERR                 =  1
               IF   SYU-KOH-HKNNUM(IDX)(1:1) NOT = "0" AND "9"
                 IF     IDX                 =  1
                   IF  SYU-SYUCOMPFTN-ENTANI
                                        >  SYU-KOH-COMPFTN-ENTANI(IDX)
                     MOVE     ZERO         TO  FLG-ERR
                   END-IF
                 ELSE
                   IF  SYU-KOH-COMPFTN-ENTANI(IDX - 1)
                                        >  SYU-KOH-COMPFTN-ENTANI(IDX)
                     MOVE     ZERO         TO  FLG-ERR
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
      *    £µ£´£³¤ò»ÈÍÑ¤·¤Æ¤¤¤ë¾ì¹ç¡¢ÅÀ¿ô¤Î£±³äÁêÅö³Û¤ò½¸·×¤¹¤ë
             IF  SYU-KOH-HKNNUM(IDX)  =  "543"
               PERFORM  8001-SEIKYU-SEC
             END-IF
      *
      *=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) start
      *    °°Àî¾ã¤Î¾ì¹ç¡¢½é¿Ç»þ°ìÉôÉéÃ´¶â¤È¤Îº¹³Û¤òµ­ºÜ
      *    ¡ÊËÜÂÎÂ¦¤ÇSYU-KOH-COMPFTN-ENTANI¤Ë·×»»ºÑ¤ß¡Ë
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) start
      *       IF  SYU-KOH-HKNNUM(IDX)  =  "643" OR "743"
             IF  SYU-KOH-HKNNUM(IDX)  =  "643"
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) end
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) start
               IF  SYU-KOH-COMPFTN-ENTANI(IDX)  =  ZERO
      *          »Ô½õÀ®Ê¬¤ò½¸·×
                 ADD  SYU-KOH-COMPFTN(IDX)         TO  WRK-ASAHIFTN
               END-IF
      *        ½é¿ÇÈ½ÄêÍÑ¤ËCOMPFTN½¸·×
               ADD    SYU-KOH-COMPFTN(IDX)         TO  WRK-COMPFTN
      *=== °°Àî»Ô¤ÎÈ÷¹ÍÍó¶â³Û·×»»½¤Àµ by Yoshikawa(2013/03/18) end
               ADD    SYU-KOH-COMPFTN-ENTANI(IDX)  TO  WRK-ETC-ITBFTN
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) start
             ELSE
               IF  SYU-KOH-HKNNUM(IDX)  =  "743"
                 IF  SYU-KOH-COMPFTN-ENTANI(IDX)  =  ZERO
      *            »Ô½õÀ®Ê¬¤ò½¸·×
                   ADD  SYU-SYUCOMPFTN-ENTANI      TO  WRK-ASAHIFTN
                 END-IF
                 ADD  SYU-KOH-COMPFTN-ENTANI(IDX)  TO  WRK-ETC-ITBFTN
               END-IF
      *=== 743»ÈÍÑ»þ¤ÎÈ÷¹ÍÍó¤Î¶â³Û½¤Àµ by Yoshikawa(2014/03/10) end
             END-IF
      *=== °°Àî»Ô¤Î°ìÉôÉéÃ´¶â·×»»½¤Àµ by Yoshikawa(2012/12/13) end
      *
      *=== ¸øÈñ¤Î½õÀ®È½ÄêÊÑ¹¹ by Yoshikawa(2009/09/29) start
      *    Ä¹´üµÚ¤ÓÁ´¹ñ¸øÈñ¤òÊ»ÍÑ¤·¤Æ¤¤¤ë¾ì¹ç¤Ï¸øÈñ¤Î½õÀ®¤¬¤Ê¤¯¤Æ¤âµ­ºÜ
             IF  SYU-KOH-HKNNUM(IDX)(1:1)  =  "0"
             OR  SYU-KOH-HKNNUM(IDX)       =  "972"
             OR  SYU-KOH-HKNNUM(IDX)       =  "974"
                MOVE  ZERO                 TO  FLG-ERR
             END-IF
      *=== ¸øÈñ¤Î½õÀ®È½ÄêÊÑ¹¹ by Yoshikawa(2009/09/29) end
      *
      *=== ¸øÈñ½õÀ®È½Äê¤Î½¤Àµ by Yoshikawa(2010/03/25) start
      **=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
      **    Æ±ÊÝ¸±¡¢Æ±Æþ³°¶èÊ¬¤Ç¿ÇÎÅ¤¬Ê£¿ôÆü¤¢¤ë¾ì¹ç¤Ï½èÍýÈ½Äê¤ò¹Ô¤ï¤Ê¤¤
      **    ¡Ê¤½¤ÎÁ°¤Î¿ÇÎÅ¤ÇÁ´¹ñ¸øÈñ¤ÎÉéÃ´¤¬¤¢¤ë¤«¤é¡Ë
      *       IF  SYU-KOH-HKNNUM(IDX)(1:1)  =  "0" 
      *       AND WRK-SRYCNT  <  2
      **        Áë¸ýÉéÃ´¤¬È¯À¸¤·¤Ê¤¤Á´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³°
      *         IF  SYU-KOH-COMPFTN-ENTANI(IDX)  =  ZERO
      *           MOVE  1                   TO  FLG-ERR2
      *         END-IF
      *       END-IF
      **=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
             IF  FLG-SYORI2  =  ZERO
               IF  SYU-KOH-HKNNUM(IDX)(1:1)  =  "0" 
      *=== ÉéÃ´Ìµ¤·¤ÎÆ»ÆñÉÂ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2015/08/12) start
               OR  SYU-KOH-HKNNUM(IDX)       =  "283" OR "383"
      *=== ÉéÃ´Ìµ¤·¤ÎÆ»ÆñÉÂ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2015/08/12) end
                 MOVE  1                   TO  FLG-ERR2
      *
      *          Áë¸ýÉéÃ´¤¬È¯À¸¤·¤Ê¤¤Á´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³°
                 IF  SYU-KOH-COMPFTN-ENTANI(IDX)  NOT =  ZERO
                   MOVE  ZERO              TO  FLG-ERR2
                   MOVE  1                 TO  FLG-SYORI2
                 END-IF
               END-IF
             END-IF
      *=== ¸øÈñ½õÀ®È½Äê¤Î½¤Àµ by Yoshikawa(2010/03/25) end
      *
           END-PERFORM
      *
           ADD     WRK-SEIKYUGK            TO  WRK-SEIKYUGK-G2
      *
           .
       800-SEIKYU-SEC-EXT.
           EXIT.
      *
      *****************************************************************
      *    £±³äÁêÅö³Û·×»»
      *****************************************************************
       8001-SEIKYU-SEC  SECTION.
      *
           MOVE  SYU-TOTAL-HKNTEN         TO  WRK-KEISAN
      *    ÊÝ¸±¤Ë¸ÂÅÙ³Û¤¬¤¢¤ë¾ì¹ç¤Ï£±£°±ßÃ±°Ì
           IF  RECE02-FTNMONEY(1)  >  ZERO
      *
      *    ÅÀ¿ô¤Î£±³äÊ¬¤Î¶â³Û¤ò»Í¼Î¸ÞÆþ
             DISPLAY "»Í¼Î¸ÞÆþÁ°=" SYU-TOTAL-HKNTEN
             DIVIDE  SYU-TOTAL-HKNTEN  BY  10  GIVING  WRK-KEISAN
                     REMAINDER  WRK-AMARI
             COMPUTE  WRK-KEISAN  =  SYU-TOTAL-HKNTEN - WRK-AMARI
             IF  WRK-AMARI     >     4
               ADD  10                     TO  WRK-KEISAN
             END-IF
             DISPLAY "»Í¼Î¸ÞÆþ¸å=" WRK-KEISAN
             IF  IDX     =     1
               IF  SYU-SYUCOMPFTN         <  WRK-KEISAN
                 ADD  SYU-SYUCOMPFTN         TO WRK-ETC-ITBFTN
               ELSE
                 ADD  WRK-KEISAN             TO WRK-ETC-ITBFTN
               END-IF
             ELSE
               IF SYU-KOH-COMPFTN(IDX - 1) < WRK-KEISAN
                 ADD  SYU-KOH-COMPFTN(IDX - 1)
                                             TO WRK-ETC-ITBFTN
               ELSE
                 ADD  WRK-KEISAN             TO WRK-ETC-ITBFTN
               END-IF
             END-IF
      *
      *
           ELSE
      *
      *    ¸ÂÅÙ³Û¤¬Ìµ¤¤¾ì¹ç¤Ï£±±ßÃ±°Ì
             IF  IDX     =     1
               IF  SYU-SYUCOMPFTN-ENTANI  <  WRK-KEISAN
                 ADD  SYU-SYUCOMPFTN-ENTANI  TO WRK-ETC-ITBFTN
               ELSE
                 ADD  WRK-KEISAN             TO WRK-ETC-ITBFTN
               END-IF
             ELSE
               IF SYU-KOH-COMPFTN-ENTANI(IDX - 1) < WRK-KEISAN
                 ADD  SYU-KOH-COMPFTN-ENTANI(IDX - 1)
                                             TO WRK-ETC-ITBFTN
               ELSE
                 ADD  WRK-KEISAN             TO WRK-ETC-ITBFTN
               END-IF
             END-IF
           END-IF
      *
           .
       8001-SEIKYU-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¼ýÇ¼¾ðÊó¥»¥Ã¥È
      *****************************************************************
       920-SYUNOU-SET-SEC  SECTION.
      *
             INITIALIZE  SYUNOU-REC
      *=== ¸øÈñ½õÀ®È½Äê¤Î½¤Àµ by Yoshikawa(2010/03/25) start
                         FLG-SYORI2
      *=== ¸øÈñ½õÀ®È½Äê¤Î½¤Àµ by Yoshikawa(2010/03/25) end
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
             MOVE   1                 TO  WRK-SRYCNT
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
      *---(01.00.08) LINE ADD START ------------------------------------
      *       MOVE  RECE02-HOSPID      TO  SYU-HOSPID
             MOVE  SPA-HOSPNUM        TO  SYU-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
             MOVE  RECE02-NYUGAIKBN   TO  SYU-NYUGAIKBN
             MOVE  RECE02-PTID        TO  SYU-PTID
             MOVE  RECE02-SRYYM(1:6)  TO  SYU-SRYYMD(1:6)
             MOVE  "__"               TO  SYU-SRYYMD(7:2)
             MOVE  WRK-KOHNUM         TO  SYU-KOH-HKNNUM(1)
                                          SYU-KOH-HKNNUM(2)
                                          SYU-KOH-HKNNUM(3)
                                          SYU-KOH-HKNNUM(4)
             MOVE  SYUNOU-REC         TO  MCPDATA-REC
             MOVE  "DBSELECT"         TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *       MOVE  WRK-PATH           TO  MCP-PATH
      *       CALL  "MCPSUB"           USING
      *                                MCPAREA
      *                                MCPDATA-REC
             MOVE  "tbl_syunou"       TO  MCP-TABLE
             MOVE  WRK-PATH           TO  MCP-PATHNAME
             CALL  "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
             IF  MCP-RC  =  ZERO
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE  WRK-PATH         TO  MCP-PATH
               MOVE  "tbl_syunou"       TO  MCP-TABLE
               MOVE  WRK-PATH           TO  MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
               PERFORM  925-SYUNOU-READ-SEC
      *
               PERFORM  UNTIL  FLG-SYUNOU  =  1
                 IF  SYU-DENPJTIKBN   NOT = "3"
                   IF    SYU-HKNCOMBINUM  =  RECE02-HKNCOMBI(1) OR
                                             RECE02-HKNCOMBI(2) OR
                                             RECE02-HKNCOMBI(3) OR
                                             RECE02-HKNCOMBI(4) OR
                                             RECE02-HKNCOMBI(5) OR
                                             RECE02-HKNCOMBI(6) OR
                                             RECE02-HKNCOMBI(7) OR
                                             RECE02-HKNCOMBI(8) OR
                                             RECE02-HKNCOMBI(9) OR
                                             RECE02-HKNCOMBI(10)   
                      PERFORM  910-HKNCOMBI-READ-SEC
                      IF  COMB-KOHID(1)    =  WRK-KOHID   OR
                          COMB-KOHID(2)    =  WRK-KOHID   OR
                          COMB-KOHID(3)    =  WRK-KOHID   OR
                          COMB-KOHID(4)    =  WRK-KOHID
      *
                        PERFORM  800-SEIKYU-SEC
      *
      *              243¤Î¤ß»ÈÍÑ¤·¤Æ¤¤¤ë¾ì¹ç¡¢°ìÉôÉéÃ´¶âÁêÅö³Û¤ò½¸·×¤¹¤ë
                        IF     MF100-KOHNUM  =  "243"
                          PERFORM  2002-SYOSIN-CHK-SEC
                        END-IF
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) start
                        ADD  1          TO  WRK-SRYCNT
      *=== ´µ¼ÔÉéÃ´Ìµ¤ÎÁ´¹ñ¸øÈñ¤Ï°õ»úÂÐ¾Ý³° by Yoshikawa(2009/10/22) end
      *
                      END-IF
      *
                   END-IF
                 END-IF
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *           MOVE  WRK-PATH        TO  MCP-PATH
                 MOVE  "tbl_syunou"     TO  MCP-TABLE
                 MOVE  WRK-PATH         TO  MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
                 PERFORM   925-SYUNOU-READ-SEC
               END-PERFORM
             ELSE
               DISPLAY  "SYUNOU SELECT ERR"
             END-IF
      *
             INITIALIZE  MCPAREA
             MOVE  "DBCLOSECURSOR"      TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *       MOVE  WRK-PATH             TO  MCP-PATH
      *       CALL  "MCPSUB"     USING
      *                          MCPAREA
      *                          MCPDATA-REC
             MOVE  "tbl_syunou"         TO  MCP-TABLE
             MOVE  WRK-PATH             TO  MCP-PATHNAME
             CALL  "ORCDBMAIN"          USING
                                        MCPAREA
                                        MCPDATA-REC
                                        SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       920-SYUNOU-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼ýÇ¼ÆÉ¹þ
      *****************************************************************
       925-SYUNOU-READ-SEC  SECTION.
      *
           MOVE  "DBFETCH"  TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC
           CALL  "ORCDBMAIN"          USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF  MCP-RC  =  ZERO
             MOVE  MCPDATA-REC  TO  SYUNOU-REC
             MOVE  ZERO         TO  FLG-SYUNOU
           ELSE
             INITIALIZE  SYUNOU-REC
             MOVE  1  TO  FLG-SYUNOU
           END-IF
      *
           .
       925-SYUNOU-READ-EXT.
           EXIT.
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¡¼ÆÉ¤ß¹þ¤ß
      *****************************************************************
       910-HKNCOMBI-READ-SEC         SECTION.
      *
           INITIALIZE                      HKNCOMBI-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    SYU-HOSPID                 TO  COMB-HOSPID
           MOVE    SPA-HOSPNUM                TO  COMB-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE    SYU-PTID                   TO  COMB-PTID
           MOVE    SYU-HKNCOMBINUM            TO  COMB-HKNCOMBINUM
           MOVE    HKNCOMBI-REC               TO  MCPDATA-REC
           MOVE    "DBSELECT"                 TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-HKNCOMBI-KEY      TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_hkncombi"        TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               MOVE    "DBFETCH"                  TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *         MOVE    PATH-TBL-HKNCOMBI-KEY      TO  MCP-PATH
      *         CALL    "MCPSUB"             USING
      *                                      MCPAREA
      *                                      MCPDATA-REC
               MOVE    "tbl_hkncombi"        TO  MCP-TABLE
               MOVE    "key"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"           USING
                                             MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  HKNCOMBI-REC
                   MOVE    ZERO            TO  FLG-HKNCOMBI
               ELSE
                   INITIALIZE                  HKNCOMBI-REC
                   MOVE    1               TO  FLG-HKNCOMBI
               END-IF
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           MOVE    "DBCLOSECURSOR"           TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-HKNCOMBI-KEY     TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_hkncombi"        TO  MCP-TABLE
           MOVE    "key"                 TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       910-HKNCOMBI-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¾ðÊó   2005/09/14 yamaguchi INS
      *****************************************************************
       920-SRYACT-SET-SEC         SECTION.
      *
           MOVE    SRYACT-REC              TO  MCPDATA-REC
           MOVE    "DBSELECT"              TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-SRYACT-KEY     TO  MCP-PATH
      *     CALL    "MCPSUB"                USING
      *                                     MCPAREA
      *                                     MCPDATA-REC
           MOVE    "tbl_sryact"       TO  MCP-TABLE
           MOVE    "key"              TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC               =   ZERO
                   MOVE    "DBFETCH"               TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *             MOVE    PATH-TBL-SRYACT-KEY     TO  MCP-PATH
      *             CALL    "MCPSUB"                USING
      *                                             MCPAREA
      *                                             MCPDATA-REC
                   MOVE    "tbl_sryact"       TO  MCP-TABLE
                   MOVE    "key"              TO  MCP-PATHNAME
                   CALL    "ORCDBMAIN"        USING
                                              MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
                   IF      MCP-RC              =   ZERO
                           MOVE    MCPDATA-REC     TO  SRYACT-REC
                           MOVE    ZERO            TO  FLG-SRYACT
                   ELSE
                           MOVE   1               TO  FLG-SRYACT
                           INITIALIZE             SRYACT-REC
                   END-IF
           ELSE
                   MOVE   1               TO  FLG-SRYACT
           END-IF
      *
           MOVE    "DBCLOSECURSOR"         TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-SRYACT-KEY     TO  MCP-PATH
      *     CALL    "MCPSUB"                USING
      *                                     MCPAREA
      *                                     MCPDATA-REC
           MOVE    "tbl_sryact"       TO  MCP-TABLE
           MOVE    "key"              TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       920-SRYACT-SET-EXT.
           EXIT.
      *****************************************************************
      *   ÊÝ¸±ÈÖ¹æ¾ðÊó¥»¥Ã¥È(¾å¸Â³Û¼èÆÀ)
      *****************************************************************
       940-HKNNUM-SET-SEC  SECTION.
      *
           INITIALIZE  HKNNUM-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  SYS-1001-HOSPID             TO  HKN-HOSPID
           MOVE  SPA-HOSPNUM                 TO  HKN-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  "343"                       TO  HKN-HKNNUM
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) start
           MOVE  LNK-PRTKANRI-SRYYM(1:6)     TO  HKN-TEKSTYMD(1:6)
                                                 HKN-TEKEDYMD(1:6)
           MOVE  "01"                        TO  HKN-TEKSTYMD(7:2)
                                                 HKN-TEKEDYMD(7:2)
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) end
           MOVE  HKNNUM-REC                  TO  MCPDATA-REC
           MOVE  "DBSELECT"                  TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-HKNNUM-KEY2        TO  MCP-PATH
      *     CALL  "MCPSUB"             USING
      *                                MCPAREA
      *                                MCPDATA-REC
           MOVE    "tbl_hknnum"       TO  MCP-TABLE
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) start
      *     MOVE    "key2"             TO  MCP-PATHNAME
           MOVE    "key5"             TO  MCP-PATHNAME
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) end
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF  MCP-RC  =  ZERO
             PERFORM  945-HKNNUM-READ-SEC
      *
           ELSE
             DISPLAY  "HKNNUM SELECT ERR"
           END-IF
      *
           INITIALIZE  MCPAREA
           MOVE  "DBCLOSECURSOR"         TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-HKNNUM-KEY2    TO  MCP-PATH
      *     CALL  "MCPSUB"         USING
      *                            MCPAREA
      *                            MCPDATA-REC
           MOVE    "tbl_hknnum"       TO  MCP-TABLE
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) start
      *     MOVE    "key2"             TO  MCP-PATHNAME
           MOVE    "key5"             TO  MCP-PATHNAME
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) end
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       940-HKNNUM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¾ðÊóÆÉ¹þ
      *****************************************************************
       945-HKNNUM-READ-SEC  SECTION.
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-HKNNUM-KEY2      TO  MCP-PATH
      *     MOVE  "DBFETCH"                 TO  MCP-FUNC
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC
           MOVE    "DBFETCH"          TO  MCP-FUNC
           MOVE    "tbl_hknnum"       TO  MCP-TABLE
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) start
      *     MOVE    "key2"             TO  MCP-PATHNAME
           MOVE    "key5"             TO  MCP-PATHNAME
      *=== keyÊÑ¹¹ by Yoshikawa(2015/06/11) end
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF  MCP-RC  =  ZERO
             MOVE  MCPDATA-REC  TO  HKNNUM-REC
             MOVE  ZERO         TO  FLG-HKNNUM
      *
             IF  SYS-1001-SYOHOKBN   =   "0"
               MOVE  HKN-HON-GAIMNAIJGNGAK  TO  WRK-G-JOUGENGK
             ELSE
               MOVE  HKN-HON-GAIMGAIJGNGAK  TO  WRK-G-JOUGENGK
             END-IF
             MOVE  HKN-HON-NYUMJGNGAK       TO  WRK-N-JOUGENGK
             DISPLAY "³°Íè¾å¸Â³Û=" WRK-G-JOUGENGK
             DISPLAY "Æþ±¡¾å¸Â³Û=" WRK-N-JOUGENGK
      *
             IF    HKN-HKNNUM  =  "051"
               INITIALIZE                HKN-TANSEIDONAME
               MOVE    "ÆÃÄê¼À´µ"   TO   HKN-TANSEIDONAME
             END-IF
      *
           ELSE
             INITIALIZE  HKNNUM-REC
             MOVE  1            TO  FLG-HKNNUM
           END-IF
      *
           .
       945-HKNNUM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¾ðÊó¸¡º÷   
      *****************************************************************
       950-JYUSIN-SELECT-SEC   SECTION.
      *
           INITIALIZE                       JYURRK-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    SYU-HOSPID                  TO  JYURRK-HOSPID
           MOVE    SPA-HOSPNUM                 TO  JYURRK-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE    SYU-PTID                    TO  JYURRK-PTID
           MOVE    SYU-NYUGAIKBN               TO  JYURRK-NYUGAIKBN
           MOVE    SYU-DENPNUM                 TO  JYURRK-DENPNUM
           MOVE    JYURRK-REC                  TO  MCPDATA-REC
           MOVE    "DBSELECT"                  TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-JYURRK-KEY6        TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_jyurrk"       TO  MCP-TABLE
           MOVE    "key6"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               MOVE    ZERO                TO  FLG-JYURRK
               PERFORM  950-JYUSIN-FETCH-SEC
           ELSE
               MOVE    1                   TO  FLG-JYURRK
               INITIALIZE                  JYURRK-REC
           END-IF
      *
           .
       950-JYUSIN-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¾ðÊóFETCH    
      *****************************************************************
       950-JYUSIN-FETCH-SEC  SECTION.
      *
           MOVE    "DBFETCH"                  TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-JYURRK-KEY6       TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_jyurrk"       TO  MCP-TABLE
           MOVE    "key6"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  JYURRK-REC
               MOVE    ZERO                TO  FLG-JYURRK
           ELSE
               MOVE    1                   TO  FLG-JYURRK
               INITIALIZE                  JYURRK-REC
           END-IF
      *
           .
       950-JYUSIN-FETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¾ðÊóCLOSE    
      *****************************************************************
       950-JYUSIN-CLOSE-SEC  SECTION.
      *
      *
           MOVE    "DBCLOSECURSOR"          TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    PATH-TBL-JYURRK-KEY6     TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_jyurrk"       TO  MCP-TABLE
           MOVE    "key6"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       950-JYUSIN-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¾ðÊóSELECT  
      *****************************************************************
       900-SRYACCT-SELECT-SEC         SECTION.
      *
           MOVE    SRYACCT-REC          TO  MCPDATA-REC
           MOVE    "DBSELECT"           TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    WRK-SRYACCT-PATH     TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_sryacct"      TO  MCP-TABLE
           MOVE    WRK-SRYACCT-PATH   TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC           =   ZERO
                   MOVE   ZERO            TO  FLG-SRYACCT
                   PERFORM  900-SRYACCT-FETCH-SEC
           ELSE
                   MOVE   1               TO  FLG-SRYACCT
           END-IF
      *
           .
       900-SRYACCT-SELECT-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¾ðÊó£±·ïÆÉ¤ß¹þ¤ß
      *****************************************************************
       900-SRYACCT-FETCH-SEC         SECTION.
      *
           MOVE    "DBFETCH"            TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    WRK-SRYACCT-PATH     TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_sryacct"      TO  MCP-TABLE
           MOVE    WRK-SRYACCT-PATH   TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  SRYACCT-REC
                   MOVE    ZERO            TO  FLG-SRYACCT
           ELSE
                   MOVE    1               TO  FLG-SRYACCT
           END-IF
           .
       900-SRYACCT-FETCH-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¾ðÊó¥¯¥í¡¼¥º  
      *****************************************************************
       900-SRYACCT-CLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"        TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE    WRK-SRYACCT-PATH       TO  MCP-PATH
      *     CALL    "MCPSUB"             USING
      *                                  MCPAREA
      *                                  MCPDATA-REC
           MOVE    "tbl_sryacct"      TO  MCP-TABLE
           MOVE    WRK-SRYACCT-PATH   TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING
                                      MCPAREA
                                      MCPDATA-REC
                                      SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           .
       900-SRYACCT-CLOSE-EXT.
           EXIT.
      *****************************************************************
      *   ÊÝ¸±¼Ô¾ðÊó¥»¥Ã¥È
      *****************************************************************
       920-HKNJAINF-SET-SEC  SECTION.
      *
           INITIALIZE  HKNJAINF-REC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  SYS-1001-HOSPID              TO  HKNJA-HOSPID
           MOVE  SPA-HOSPNUM                  TO  HKNJA-HOSPNUM
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  WRK-HKNJANUM                 TO  HKNJA-HKNJANUM
           MOVE  HKNJAINF-REC                 TO  MCPDATA-REC
           MOVE  "DBSELECT"                   TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-HKNJAINF-KEY2       TO  MCP-PATH
      *     CALL  "MCPSUB"             USING
      *                                MCPAREA
      *                                MCPDATA-REC
           MOVE  "tbl_hknjainf"     TO  MCP-TABLE
           MOVE  "key2"             TO  MCP-PATHNAME
           CALL  "ORCDBMAIN"        USING
                                    MCPAREA
                                    MCPDATA-REC
                                    SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF  MCP-RC  =  ZERO
             PERFORM  925-HKNJAINF-READ-SEC
           ELSE
             DISPLAY  "HKNJAINF SELECT ERR"
           END-IF
      *
           INITIALIZE  MCPAREA
           MOVE  "DBCLOSECURSOR"          TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-HKNJAINF-KEY2   TO  MCP-PATH
      *     CALL  "MCPSUB"         USING
      *                            MCPAREA
      *                            MCPDATA-REC
           MOVE  "tbl_hknjainf"     TO  MCP-TABLE
           MOVE  "key2"             TO  MCP-PATHNAME
           CALL  "ORCDBMAIN"        USING
                                    MCPAREA
                                    MCPDATA-REC
                                    SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       920-HKNJAINF-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±¼Ô¾ðÊóÆÉ¹þ
      *****************************************************************
       925-HKNJAINF-READ-SEC  SECTION.
      *
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-HKNJAINF-KEY2     TO  MCP-PATH
      *     MOVE  "DBFETCH"                  TO  MCP-FUNC
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC
           MOVE  "DBFETCH"          TO  MCP-FUNC
           MOVE  "tbl_hknjainf"     TO  MCP-TABLE
           MOVE  "key2"             TO  MCP-PATHNAME
           CALL  "ORCDBMAIN"        USING
                                    MCPAREA
                                    MCPDATA-REC
                                    SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF  MCP-RC  =  ZERO
             MOVE  MCPDATA-REC  TO  HKNJAINF-REC
             MOVE  ZERO         TO  FLG-HKNJAINF
      *
      *    ¹ñÊÝ¤Ç¤Ê¤¤»þ¤Ï¡¢ÆÉ¤ßÄ¾¤¹
             IF    HKNJA-HKNNUM  NOT  =  "060" AND "067"
               GO               TO    925-HKNJAINF-READ-SEC
             END-IF
      *
           ELSE
             INITIALIZE  HKNJAINF-REC
             MOVE  1            TO  FLG-HKNJAINF
           END-IF
      *
           .
       925-HKNJAINF-READ-EXT.
           EXIT.
      *
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) start
      *****************************************************************
      *  ¿ÇÎÅ¾ðÊó¥»¥Ã¥È
      *****************************************************************
       960-SRYACT-SET-SEC  SECTION.
      *
             INITIALIZE  SRYACT-REC
             MOVE  SPA-HOSPNUM           TO  SRY-HOSPNUM
             MOVE  RECE02-NYUGAIKBN      TO  SRY-NYUGAIKBN
             MOVE  RECE02-PTID           TO  SRY-PTID
             MOVE  RECE02-SRYYM          TO  SRY-SRYYM
             MOVE  SRYACT-REC            TO  MCPDATA-REC
             MOVE  "DBSELECT"            TO  MCP-FUNC
             MOVE  "tbl_sryact"          TO  MCP-TABLE
             MOVE  "key4"                TO  MCP-PATHNAME
             CALL  "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
             IF  MCP-RC  =  ZERO
               MOVE  "tbl_sryact"        TO  MCP-TABLE
               MOVE  "key4"              TO  MCP-PATHNAME
               PERFORM  965-SRYACT-READ-SEC
      *    ºßÁí¿Ç¤Î´µ¼Ô¼èÆÀ
               PERFORM  UNTIL  FLG-SRYACT  =  1
                 PERFORM  965-ZAISOU-CHK-SEC
      *
                 MOVE  "tbl_sryact"      TO  MCP-TABLE
                 MOVE  "key4"            TO  MCP-PATHNAME
                 PERFORM  965-SRYACT-READ-SEC
               END-PERFORM
             ELSE
               DISPLAY  "SRYACT SELECT ERR"
             END-IF
      *
             INITIALIZE  MCPAREA
             MOVE  "DBCLOSECURSOR"       TO  MCP-FUNC
             MOVE  "tbl_sryact"          TO  MCP-TABLE
             MOVE  "key4"                TO  MCP-PATHNAME
             CALL  "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
      *
           .
       960-SRYACT-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¾ðÊóÆÉ¹þ
      *****************************************************************
       965-SRYACT-READ-SEC  SECTION.
      *
           MOVE  "DBFETCH"      TO  MCP-FUNC
           CALL  "ORCDBMAIN"        USING
                                    MCPAREA
                                    MCPDATA-REC
                                    SPA-AREA
           IF  MCP-RC  =  ZERO
             MOVE  MCPDATA-REC  TO  SRYACT-REC
             MOVE  ZERO         TO  FLG-SRYACT
           ELSE
             INITIALIZE   SRYACT-REC
             MOVE  1  TO  FLG-SRYACT
           END-IF
      *
           .
       965-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºßÁí¿Ç¥Á¥§¥Ã¥¯
      *****************************************************************
       965-ZAISOU-CHK-SEC  SECTION.
      *
           PERFORM  VARYING  IDX4  FROM  1  BY  1
                    UNTIL   (IDX4  >     5) OR
                            (SRY-SRYCD(IDX4)  =  SPACE)
             IF  SRY-SRYKBN  =  "14"
      *=== ºßÂð¥³¡¼¥ÉÊÑ¹¹ by Yoshikawa(2014/05/20) start
      **=== ºßÂð¤ÎÂÐ¾Ý¥³¡¼¥É¤òÁý¤ä¤¹ by Yoshikawa(2013/07/26) start
      **         IF  SRY-SRYCD(IDX4)  =  WRK-CONS-ZAITAKU1  OR
      **                                 WRK-CONS-ZAITAKU2  OR
      **                                 WRK-CONS-ZAITAKU3  OR
      **                                 WRK-CONS-ZAITAKU4  OR
      **                                 WRK-CONS-ZAITAKU5  OR
      **                                 WRK-CONS-ZAITAKU6
      *         IF  SRY-SRYCD(IDX4)  =  WRK-CONS-ZAITAKU1
      *                             OR  WRK-CONS-ZAITAKU2
      *                             OR  WRK-CONS-ZAITAKU3
      *                             OR  WRK-CONS-ZAITAKU4
      *                             OR  WRK-CONS-ZAITAKU5
      *                             OR  WRK-CONS-ZAITAKU6
      *                             OR  WRK-CONS-ZAITAKU7
      *                             OR  WRK-CONS-ZAITAKU8
      *                             OR  WRK-CONS-ZAITAKU9
      *                             OR  WRK-CONS-ZAITAKU10
      *                             OR  WRK-CONS-ZAITAKU11
      *                             OR  WRK-CONS-ZAITAKU12
      *                             OR  WRK-CONS-ZAITAKU13
      *                             OR  WRK-CONS-ZAITAKU14
      *                             OR  WRK-CONS-ZAITAKU15
      *                             OR  WRK-CONS-ZAITAKU16
      *                             OR  WRK-CONS-ZAITAKU17
      *                             OR  WRK-CONS-ZAITAKU18
      **=== ºßÂð¤ÎÂÐ¾Ý¥³¡¼¥É¤òÁý¤ä¤¹ by Yoshikawa(2013/07/26) end
      *           MOVE  "1"  TO  MF100-ZAITAKU
      *         END-IF
               IF  RECE02-SRYYM  >=  WRK-CONS-SRYYM-201404
                 PERFORM  VARYING  IDX5  FROM  1  BY  1
                          UNTIL   (IDX5  >  TBL-ZAITAKU2-MAX)
                          OR      (MF100-ZAITAKU  =  "1")
                   IF  SRY-SRYCD(IDX4)  =  TBL-ZAITAKU2(IDX5)
                       MOVE    "1"     TO  MF100-ZAITAKU
                   END-IF
                 END-PERFORM
               ELSE
                 PERFORM  VARYING  IDX5  FROM  1  BY  1
                          UNTIL   (IDX5  >  TBL-ZAITAKU-MAX)
                          OR      (MF100-ZAITAKU  =  "1")
                   IF  SRY-SRYCD(IDX4)  =  TBL-ZAITAKU(IDX5)
                       MOVE    "1"     TO  MF100-ZAITAKU
                   END-IF
                 END-PERFORM
               END-IF
      *=== ºßÂð¥³¡¼¥ÉÊÑ¹¹ by Yoshikawa(2014/05/20) end
             END-IF
           END-PERFORM
      *
           .
       965-ZAISOU-CHK-EXT.
           EXIT.
      *=== 70ºÐÌ¤Ëþ¤Ç¤âºßÂð¤òµ­ºÜ by Yoshikawa(2013/06/10) end
      *****************************************************************
      *    ·îËöÆü»»½Ð½èÍý
      *****************************************************************
       31012-LASTDAY-GET-SEC        SECTION.
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY7-AREA
           MOVE    "71"                   TO  LNK-DAY7-IRAI
           MOVE    WRK-SYMD     TO  LNK-DAY7-YM
           CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                  LNK-DAY7-AREA
           MOVE LNK-DAY7-KOYOMI  TO  WRK-SYMD
           .
       31012-LASTDAY-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ÉÍý¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
      *****************************************************************
       800-SYSKANRI-READ-SEC  SECTION.
      *
           MOVE  "DBSELECT"                TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-SYSKANRI-KEY10   TO  MCP-PATH
      *     CALL  "MCPSUB"         USING
      *                            MCPAREA
      *                            MCPDATA-REC
           MOVE  "tbl_syskanri"        TO  MCP-TABLE
           MOVE  "key10"               TO  MCP-PATHNAME
           CALL  "ORCDBMAIN"           USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF  MCP-RC  =  ZERO
             MOVE  "DBFETCH"                TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *       MOVE  PATH-TBL-SYSKANRI-KEY10  TO  MCP-PATH
      *       CALL  "MCPSUB"        USING
      *                             MCPAREA
      *                             MCPDATA-REC
             MOVE  "tbl_syskanri"        TO  MCP-TABLE
             MOVE  "key10"               TO  MCP-PATHNAME
             CALL  "ORCDBMAIN"           USING
                                         MCPAREA
                                         MCPDATA-REC
                                         SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
             IF  MCP-RC  =  ZERO
               MOVE  ZERO  TO  FLG-SYSKANRI
             ELSE
               MOVE  1  TO  FLG-SYSKANRI
             END-IF
           ELSE
             MOVE  1  TO  FLG-SYSKANRI
           END-IF
      *
           MOVE  "DBCLOSECURSOR"          TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     MOVE  PATH-TBL-SYSKANRI-KEY10  TO  MCP-PATH
      *     CALL  "MCPSUB"        USING
      *                           MCPAREA
      *                           MCPDATA-REC
           MOVE  "tbl_syskanri"           TO  MCP-TABLE
           MOVE  "key10"                  TO  MCP-PATHNAME
           CALL  "ORCDBMAIN"              USING
                                          MCPAREA
                                          MCPDATA-REC
                                          SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
           .
       800-SYSKANRI-READ-EXT.
           EXIT.
      *      
      *****************************************************************
      *    Á´³ÑÊÑ´¹½èÍý
      *****************************************************************
       2009-HENKAN-SEC                 SECTION.
      *
           INITIALIZE                  WRK-OUT-INPUT
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "2"                 TO  KANACHK-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF      KANACHK-RC          =   ZERO
               MOVE    KANACHK-OUT-INPUT
                                           TO  WRK-OUT-INPUT
           ELSE
               MOVE    WRK-MAE-INPUT       TO  WRK-OUT-INPUT
           END-IF
      *
           .
       2009-HENKAN-EXT.
           EXIT.
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿ÆÉ¹þ
      *****************************************************************
       900-BTPARA-READ-N-SEC          SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
      *---(01.00.08) LINE ADD START ------------------------------------
      *     CALL    "MCPSUB"            USING
      *                                 MCPAREA
      *                                 MCPDATA-REC
           CALL  "ORCDBMAIN"           USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  BTPARA-REC
               MOVE    ZERO                TO  FLG-BTPARA
           ELSE
               MOVE    1                   TO  FLG-BTPARA
               INITIALIZE                      BTPARA-REC
           END-IF
      *
           .
       900-BTPARA-READ-N-EXT.
           EXIT.
      *---(01.00.08) LINE ADD START ------------------------------------
      *****************************************************************
      *    °åÎÅµ¡´ØÊÔ½¸¾ðÊóÆÉ¤ß¹þ¤ß
      *****************************************************************
       900-1900-READ-SEC           SECTION.
      *
      *    °åÎÅµ¡´ØÊÔ½¸¾ðÊóÆÉ¤ß¹þ¤ß
           MOVE    SPACE                   TO  SYS-1900-REC
           INITIALIZE                          SYS-1900-REC
           MOVE    "1900"                  TO  SYS-1900-KANRICD
           MOVE    "*"                     TO  SYS-1900-KBNCD
           MOVE    SPA-HOSPNUM             TO  SYS-1900-HOSPNUM
           MOVE    LNK-PRTKANRI-SRYYM      TO  SYS-1900-STYUKYMD(1:6)
           MOVE    "01"                    TO  SYS-1900-STYUKYMD(7:2)
           MOVE    LNK-PRTKANRI-SRYYM      TO  SYS-1900-EDYUKYMD(1:6)
           MOVE    "01"                    TO  SYS-1900-EDYUKYMD(7:2)
           MOVE    SYS-1900-REC            TO  MCPDATA-REC
           PERFORM 800-SYSKANRI-READ-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1900-REC
               IF      SYS-1900-PRTKBN(8) NOT =   SPACE
      *            °åÎÅµ¡´ØÌ¾¾ÎÊÔ½¸¾ðÊó
                   PERFORM 900-1901-READ-SEC
      *            °åÎÅµ¡´Ø½»½êÊÔ½¸¾ðÊó
                   PERFORM 900-1902-READ-SEC
               END-IF
           ELSE
               INITIALIZE                  SYS-1900-REC
           END-IF
           .
      *
       900-1900-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    °åÎÅµ¡´ØÌ¾¾ÎÊÔ½¸¾ðÊóÆÉ¤ß¹þ¤ß
      *****************************************************************
       900-1901-READ-SEC           SECTION.
      *
      *    °åÎÅµ¡´ØÌ¾¾ÎÊÔ½¸¾ðÊóÆÉ¤ß¹þ¤ß
           MOVE    SPACE               TO  SYS-1901-REC
           INITIALIZE                      SYS-1901-REC
           MOVE    "1901"              TO  SYS-1901-KANRICD
           MOVE    SYS-1900-PRTKBN(8)  TO  SYS-1901-KBNCD
           MOVE    SPA-HOSPNUM         TO  SYS-1901-HOSPNUM
           MOVE    LNK-PRTKANRI-SRYYM  TO  SYS-1901-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-1901-STYUKYMD(7:2)
           MOVE    LNK-PRTKANRI-SRYYM  TO  SYS-1901-EDYUKYMD(1:6)
           MOVE    "01"                TO  SYS-1901-EDYUKYMD(7:2)
           MOVE    SYS-1901-REC        TO  MCPDATA-REC
           PERFORM 800-SYSKANRI-READ-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1901-REC
               MOVE    SYS-1901-HOSPNAME1  TO  WRK-HOSPNAME1
               MOVE    SYS-1901-HOSPNAME2  TO  WRK-HOSPNAME2
           ELSE
               INITIALIZE                  SYS-1901-REC
           END-IF
           .
      *
       900-1901-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    °åÎÅµ¡´Ø½»½êÊÔ½¸¾ðÊóÆÉ¤ß¹þ¤ß
      *****************************************************************
       900-1902-READ-SEC           SECTION.
      *
      *    °åÎÅµ¡´Ø½»½êÊÔ½¸¾ðÊóÆÉ¤ß¹þ¤ß
           MOVE    SPACE               TO  SYS-1902-REC
           INITIALIZE                      SYS-1902-REC
           MOVE    "1902"              TO  SYS-1902-KANRICD
           MOVE    SYS-1900-PRTKBN(8)  TO  SYS-1902-KBNCD
           MOVE    SPA-HOSPNUM         TO  SYS-1902-HOSPNUM
           MOVE    LNK-PRTKANRI-SRYYM  TO  SYS-1902-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-1902-STYUKYMD(7:2)
           MOVE    LNK-PRTKANRI-SRYYM  TO  SYS-1902-EDYUKYMD(1:6)
           MOVE    "01"                TO  SYS-1902-EDYUKYMD(7:2)
           MOVE    SYS-1902-REC        TO  MCPDATA-REC
           PERFORM 800-SYSKANRI-READ-SEC
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-1902-REC
               MOVE    SYS-1902-ADRS1  TO  WRK-HOSPADRS1
               MOVE    SYS-1902-ADRS2  TO  WRK-HOSPADRS2
               MOVE    SYS-1902-TEL    TO  WRK-HOSPTEL
           ELSE
               INITIALIZE                  SYS-1902-REC
           END-IF
           .
      *
       900-1902-READ-EXT.
           EXIT.
      *---(01.00.08) LINE ADD END   ------------------------------------
      *****************************************************************
      *    £Ä£Â¡¡¥ª¡¼¥×¥ó½èÍý
      *****************************************************************
       100-DBOPEN-SEC  SECTION.
      *
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  "DBOPEN"   TO  MCP-FUNC.
      *---(01.00.08) LINE ADD START ------------------------------------
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC.
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  "DBSTART"  TO  MCP-FUNC.
      *---(01.00.08) LINE ADD START ------------------------------------
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC.
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¡¡¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-DBDISCONNECT-SEC  SECTION.
      *
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  "DBCOMMIT"      TO  MCP-FUNC.
      *---(01.00.08) LINE ADD START ------------------------------------
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC.
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
      *
      *---(01.00.08) LINE ADD START ------------------------------------
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
      *---(01.00.08) LINE ADD END   ------------------------------------
           MOVE  "DBDISCONNECT"  TO  MCP-FUNC.
      *---(01.00.08) LINE ADD START ------------------------------------
      *     CALL  "MCPSUB"     USING
      *                        MCPAREA
      *                        MCPDATA-REC.
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *---(01.00.08) LINE ADD END   ------------------------------------
           .
       900-DBDISCONNECT-EXT.
           EXIT.
      *
